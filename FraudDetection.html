

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>FRAUD DETECTION &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'FraudDetection';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="WIND SPEED" href="WindSpeed.html" />
    <link rel="prev" title="Welcome to your Jupyter Book" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">FRAUD DETECTION</a></li>

<li class="toctree-l1"><a class="reference internal" href="WindSpeed.html">WIND SPEED</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FFraudDetection.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/FraudDetection.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>FRAUD DETECTION</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">FRAUD DETECTION</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eda">EDA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vif">VIF</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizacion">Visualización</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modelado">Modelado</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#knn-neighbors">Knn Neighbors</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#naive-bayes">Naive Bayes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#xgboost">XGBoost</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#svm">SVM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mlp">MLP</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="fraud-detection">
<h1>FRAUD DETECTION<a class="headerlink" href="#fraud-detection" title="Permalink to this heading">#</a></h1>
<p>A continuación se presenta el ánalisis y modelado resultante de transacciones reales de comercio electrónico de Vesta quienes se encargan de ofrecer soluciones de pago garantizadas de comercio electrónico. Vesta es pionera en el proceso de transacciones de pago con tarjeta no presente (CNP) totalmente garantizadas para la industria de telecomunicaciones.</p>
<section id="eda">
<h2>EDA<a class="headerlink" href="#eda" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">linear_model</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">import</span> <span class="nn">xgboost</span> <span class="k">as</span> <span class="nn">xgb</span>
<span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="kn">import</span> <span class="n">MLPRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span>
<span class="kn">import</span> <span class="nn">warnings</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fraude_identity_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;C:\MariaP\MachineLearning\Parcial\Data\fraud\train_identity.csv&quot;</span>
<span class="n">fraude_identity</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fraude_identity_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fraude_transaction_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;C:\MariaP\MachineLearning\Parcial\Data\fraud\train_transaction.csv&quot;</span>
<span class="n">fraude_transaction</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fraude_transaction_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fraude_identity</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TransactionID</th>
      <th>id_01</th>
      <th>id_02</th>
      <th>id_03</th>
      <th>id_04</th>
      <th>id_05</th>
      <th>id_06</th>
      <th>id_07</th>
      <th>id_08</th>
      <th>id_09</th>
      <th>...</th>
      <th>id_31</th>
      <th>id_32</th>
      <th>id_33</th>
      <th>id_34</th>
      <th>id_35</th>
      <th>id_36</th>
      <th>id_37</th>
      <th>id_38</th>
      <th>DeviceType</th>
      <th>DeviceInfo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2987004</td>
      <td>0.0</td>
      <td>70787.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>samsung browser 6.2</td>
      <td>32.0</td>
      <td>2220x1080</td>
      <td>match_status:2</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>T</td>
      <td>mobile</td>
      <td>SAMSUNG SM-G892A Build/NRD90M</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2987008</td>
      <td>-5.0</td>
      <td>98945.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>-5.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>mobile safari 11.0</td>
      <td>32.0</td>
      <td>1334x750</td>
      <td>match_status:1</td>
      <td>T</td>
      <td>F</td>
      <td>F</td>
      <td>T</td>
      <td>mobile</td>
      <td>iOS Device</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2987010</td>
      <td>-5.0</td>
      <td>191631.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>...</td>
      <td>chrome 62.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>F</td>
      <td>F</td>
      <td>T</td>
      <td>T</td>
      <td>desktop</td>
      <td>Windows</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2987011</td>
      <td>-5.0</td>
      <td>221832.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>-6.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>chrome 62.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>F</td>
      <td>F</td>
      <td>T</td>
      <td>T</td>
      <td>desktop</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2987016</td>
      <td>0.0</td>
      <td>7460.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>...</td>
      <td>chrome 62.0</td>
      <td>24.0</td>
      <td>1280x800</td>
      <td>match_status:2</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>T</td>
      <td>desktop</td>
      <td>MacOS</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 41 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fraude_transaction</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TransactionID</th>
      <th>isFraud</th>
      <th>TransactionDT</th>
      <th>TransactionAmt</th>
      <th>ProductCD</th>
      <th>card1</th>
      <th>card2</th>
      <th>card3</th>
      <th>card4</th>
      <th>card5</th>
      <th>...</th>
      <th>V330</th>
      <th>V331</th>
      <th>V332</th>
      <th>V333</th>
      <th>V334</th>
      <th>V335</th>
      <th>V336</th>
      <th>V337</th>
      <th>V338</th>
      <th>V339</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2987000</td>
      <td>0</td>
      <td>86400</td>
      <td>68.5</td>
      <td>W</td>
      <td>13926</td>
      <td>NaN</td>
      <td>150.0</td>
      <td>discover</td>
      <td>142.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2987001</td>
      <td>0</td>
      <td>86401</td>
      <td>29.0</td>
      <td>W</td>
      <td>2755</td>
      <td>404.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>102.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2987002</td>
      <td>0</td>
      <td>86469</td>
      <td>59.0</td>
      <td>W</td>
      <td>4663</td>
      <td>490.0</td>
      <td>150.0</td>
      <td>visa</td>
      <td>166.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2987003</td>
      <td>0</td>
      <td>86499</td>
      <td>50.0</td>
      <td>W</td>
      <td>18132</td>
      <td>567.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>117.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2987004</td>
      <td>0</td>
      <td>86506</td>
      <td>50.0</td>
      <td>H</td>
      <td>4497</td>
      <td>514.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>102.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 394 columns</p>
</div></div></div>
</div>
<p>Se realiza la unión de la información y posteriormente se reduce el uso de la memoria.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fraude</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">fraude_transaction</span><span class="p">,</span> <span class="n">fraude_identity</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span><span class="s1">&#39;TransactionID&#39;</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s2">&quot;left&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">reduce_mem_usage</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>

    <span class="n">start_mem</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="mi">1024</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">start_mem_GB</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="mi">1024</span><span class="o">**</span><span class="mi">3</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Initial memory usage of dataframe is </span><span class="si">{</span><span class="n">start_mem</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> MB/</span><span class="si">{</span><span class="n">start_mem_GB</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> GB&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">col_type</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span>
        
        <span class="k">if</span> <span class="n">col_type</span> <span class="o">!=</span> <span class="nb">object</span><span class="p">:</span>
            <span class="n">c_min</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
            <span class="n">c_max</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">col_type</span><span class="p">)[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;int&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">c_min</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span><span class="o">.</span><span class="n">min</span> <span class="ow">and</span> <span class="n">c_max</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">c_min</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span><span class="o">.</span><span class="n">min</span> <span class="ow">and</span> <span class="n">c_max</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">c_min</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span><span class="o">.</span><span class="n">min</span> <span class="ow">and</span> <span class="n">c_max</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">c_min</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span><span class="o">.</span><span class="n">min</span> <span class="ow">and</span> <span class="n">c_max</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>  
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">c_min</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span><span class="o">.</span><span class="n">min</span> <span class="ow">and</span> <span class="n">c_max</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">c_min</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">min</span> <span class="ow">and</span> <span class="n">c_max</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>

    <span class="n">end_mem</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="mi">1024</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">end_mem_GB</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="mi">1024</span><span class="o">**</span><span class="mi">3</span>
    <span class="n">reduction</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="p">(</span><span class="n">start_mem</span> <span class="o">-</span> <span class="n">end_mem</span><span class="p">)</span> <span class="o">/</span> <span class="n">start_mem</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Memory usage after optimization is: </span><span class="si">{</span><span class="n">end_mem</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> MB/</span><span class="si">{</span><span class="n">end_mem_GB</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> GB&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Decreased by </span><span class="si">{</span><span class="n">reduction</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">df</span>

<span class="n">reduce_mem_usage</span><span class="p">(</span><span class="n">fraude</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initial memory usage of dataframe is 2567.09 MB/2.51 GB
Memory usage after optimization is: 525.70 MB/0.51 GB
Decreased by 79.5%
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TransactionID</th>
      <th>isFraud</th>
      <th>TransactionDT</th>
      <th>TransactionAmt</th>
      <th>ProductCD</th>
      <th>card1</th>
      <th>card2</th>
      <th>card3</th>
      <th>card4</th>
      <th>card5</th>
      <th>...</th>
      <th>id_31</th>
      <th>id_32</th>
      <th>id_33</th>
      <th>id_34</th>
      <th>id_35</th>
      <th>id_36</th>
      <th>id_37</th>
      <th>id_38</th>
      <th>DeviceType</th>
      <th>DeviceInfo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2987000</td>
      <td>0</td>
      <td>86400</td>
      <td>68.500000</td>
      <td>W</td>
      <td>13926</td>
      <td>NaN</td>
      <td>150.0</td>
      <td>discover</td>
      <td>142.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2987001</td>
      <td>0</td>
      <td>86401</td>
      <td>29.000000</td>
      <td>W</td>
      <td>2755</td>
      <td>404.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>102.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2987002</td>
      <td>0</td>
      <td>86469</td>
      <td>59.000000</td>
      <td>W</td>
      <td>4663</td>
      <td>490.0</td>
      <td>150.0</td>
      <td>visa</td>
      <td>166.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2987003</td>
      <td>0</td>
      <td>86499</td>
      <td>50.000000</td>
      <td>W</td>
      <td>18132</td>
      <td>567.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>117.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2987004</td>
      <td>0</td>
      <td>86506</td>
      <td>50.000000</td>
      <td>H</td>
      <td>4497</td>
      <td>514.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>102.0</td>
      <td>...</td>
      <td>samsung browser 6.2</td>
      <td>32.0</td>
      <td>2220x1080</td>
      <td>match_status:2</td>
      <td>T</td>
      <td>F</td>
      <td>T</td>
      <td>T</td>
      <td>mobile</td>
      <td>SAMSUNG SM-G892A Build/NRD90M</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>590535</th>
      <td>3577535</td>
      <td>0</td>
      <td>15811047</td>
      <td>49.000000</td>
      <td>W</td>
      <td>6550</td>
      <td>NaN</td>
      <td>150.0</td>
      <td>visa</td>
      <td>226.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>590536</th>
      <td>3577536</td>
      <td>0</td>
      <td>15811049</td>
      <td>39.500000</td>
      <td>W</td>
      <td>10444</td>
      <td>225.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>224.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>590537</th>
      <td>3577537</td>
      <td>0</td>
      <td>15811079</td>
      <td>30.953125</td>
      <td>W</td>
      <td>12037</td>
      <td>595.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>224.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>590538</th>
      <td>3577538</td>
      <td>0</td>
      <td>15811088</td>
      <td>117.000000</td>
      <td>W</td>
      <td>7826</td>
      <td>481.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>224.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>590539</th>
      <td>3577539</td>
      <td>0</td>
      <td>15811131</td>
      <td>280.000000</td>
      <td>W</td>
      <td>15066</td>
      <td>170.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>102.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>590540 rows × 434 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Número de observaciones</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Número de observaciones Transaction</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fraude_transaction</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Número de observaciones Identity</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fraude_identity</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Número de observaciones Transaction(590540, 394)
Número de observaciones Identity(144233, 41)
</pre></div>
</div>
</div>
</div>
<p>El número de transacciones ID no es el mismo para la base de datos Identity, esto trae como consecuencia muchos faltantes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Tipo de variables</span>
<span class="n">fraude</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>

<span class="c1">#La mayoría de variables son númericas, mientras que solo hay 31 de tipo categóricas</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 590540 entries, 0 to 590539
Columns: 434 entries, TransactionID to DeviceInfo
dtypes: category(31), float16(354), float32(45), int16(1), int32(2), int8(1)
memory usage: 525.6 MB
</pre></div>
</div>
</div>
</div>
<p>Se realizará la eliminación de columnas y filas por faltantes y por criterio propio (ej: se eliminan la columna TransactionID que es un identificador incremental y el TransactionDT que también es incremental al ser tiempo transcurrido desde un punto de referencia).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">columnas</span> <span class="o">=</span> <span class="n">fraude</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="k">for</span> <span class="n">columna</span> <span class="ow">in</span> <span class="n">columnas</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">columna</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TransactionID
isFraud
TransactionDT
TransactionAmt
ProductCD
card1
card2
card3
card4
card5
card6
addr1
addr2
dist1
dist2
P_emaildomain
R_emaildomain
C1
C2
C3
C4
C5
C6
C7
C8
C9
C10
C11
C12
C13
C14
D1
D2
D3
D4
D5
D6
D7
D8
D9
D10
D11
D12
D13
D14
D15
M1
M2
M3
M4
M5
M6
M7
M8
M9
V1
V2
V3
V4
V5
V6
V7
V8
V9
V10
V11
V12
V13
V14
V15
V16
V17
V18
V19
V20
V21
V22
V23
V24
V25
V26
V27
V28
V29
V30
V31
V32
V33
V34
V35
V36
V37
V38
V39
V40
V41
V42
V43
V44
V45
V46
V47
V48
V49
V50
V51
V52
V53
V54
V55
V56
V57
V58
V59
V60
V61
V62
V63
V64
V65
V66
V67
V68
V69
V70
V71
V72
V73
V74
V75
V76
V77
V78
V79
V80
V81
V82
V83
V84
V85
V86
V87
V88
V89
V90
V91
V92
V93
V94
V95
V96
V97
V98
V99
V100
V101
V102
V103
V104
V105
V106
V107
V108
V109
V110
V111
V112
V113
V114
V115
V116
V117
V118
V119
V120
V121
V122
V123
V124
V125
V126
V127
V128
V129
V130
V131
V132
V133
V134
V135
V136
V137
V138
V139
V140
V141
V142
V143
V144
V145
V146
V147
V148
V149
V150
V151
V152
V153
V154
V155
V156
V157
V158
V159
V160
V161
V162
V163
V164
V165
V166
V167
V168
V169
V170
V171
V172
V173
V174
V175
V176
V177
V178
V179
V180
V181
V182
V183
V184
V185
V186
V187
V188
V189
V190
V191
V192
V193
V194
V195
V196
V197
V198
V199
V200
V201
V202
V203
V204
V205
V206
V207
V208
V209
V210
V211
V212
V213
V214
V215
V216
V217
V218
V219
V220
V221
V222
V223
V224
V225
V226
V227
V228
V229
V230
V231
V232
V233
V234
V235
V236
V237
V238
V239
V240
V241
V242
V243
V244
V245
V246
V247
V248
V249
V250
V251
V252
V253
V254
V255
V256
V257
V258
V259
V260
V261
V262
V263
V264
V265
V266
V267
V268
V269
V270
V271
V272
V273
V274
V275
V276
V277
V278
V279
V280
V281
V282
V283
V284
V285
V286
V287
V288
V289
V290
V291
V292
V293
V294
V295
V296
V297
V298
V299
V300
V301
V302
V303
V304
V305
V306
V307
V308
V309
V310
V311
V312
V313
V314
V315
V316
V317
V318
V319
V320
V321
V322
V323
V324
V325
V326
V327
V328
V329
V330
V331
V332
V333
V334
V335
V336
V337
V338
V339
id_01
id_02
id_03
id_04
id_05
id_06
id_07
id_08
id_09
id_10
id_11
id_12
id_13
id_14
id_15
id_16
id_17
id_18
id_19
id_20
id_21
id_22
id_23
id_24
id_25
id_26
id_27
id_28
id_29
id_30
id_31
id_32
id_33
id_34
id_35
id_36
id_37
id_38
DeviceType
DeviceInfo
</pre></div>
</div>
</div>
</div>
<p>Se eliminarán las columnas que tengan un % de faltantes mayor al 40% por las siguientes razones:</p>
<ul class="simple">
<li><p>La imputación tendría un efecto bastante influyente puesto que más del el 40% de los datos serían ajustados.</p></li>
<li><p>Si en la práctica no hay información de las variables, no es tan conveniente utilizar variables que no aportan mucha información.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">valores_faltantes</span> <span class="o">=</span> <span class="n">fraude</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">porcentaje_faltantes</span> <span class="o">=</span> <span class="p">(</span><span class="n">valores_faltantes</span><span class="o">/</span><span class="n">fraude</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
<span class="n">Faltantes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Columna&#39;</span><span class="p">:</span> <span class="n">valores_faltantes</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Valores Faltantes&#39;</span><span class="p">:</span> <span class="n">valores_faltantes</span><span class="p">,</span> <span class="s1">&#39;Porcentaje Faltantes&#39;</span><span class="p">:</span> <span class="n">porcentaje_faltantes</span><span class="p">})</span>
<span class="n">Faltantes</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s2">&quot;Porcentaje Faltantes&quot;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Columna</th>
      <th>Valores Faltantes</th>
      <th>Porcentaje Faltantes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id_24</th>
      <td>id_24</td>
      <td>585793</td>
      <td>99.196159</td>
    </tr>
    <tr>
      <th>id_25</th>
      <td>id_25</td>
      <td>585408</td>
      <td>99.130965</td>
    </tr>
    <tr>
      <th>id_07</th>
      <td>id_07</td>
      <td>585385</td>
      <td>99.127070</td>
    </tr>
    <tr>
      <th>id_08</th>
      <td>id_08</td>
      <td>585385</td>
      <td>99.127070</td>
    </tr>
    <tr>
      <th>id_21</th>
      <td>id_21</td>
      <td>585381</td>
      <td>99.126393</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>C3</th>
      <td>C3</td>
      <td>0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>C2</th>
      <td>C2</td>
      <td>0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>C1</th>
      <td>C1</td>
      <td>0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>isFraud</th>
      <td>isFraud</td>
      <td>0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>TransactionID</th>
      <td>TransactionID</td>
      <td>0</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
<p>434 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Se van a eliminar las columnas que tengan un % de faltantes superior a 40% (umbral personal)</span>
<span class="n">columnas_a_eliminar</span> <span class="o">=</span> <span class="n">porcentaje_faltantes</span><span class="p">[</span><span class="n">porcentaje_faltantes</span> <span class="o">&gt;</span> <span class="mi">40</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">fraude_drop</span> <span class="o">=</span> <span class="n">fraude</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columnas_a_eliminar</span><span class="p">)</span>
<span class="n">fraude_drop</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(590540, 202)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Eliminar las columnas del dominio del correo electrónico</span>

<span class="n">fraude_drop</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;P_emaildomain&quot;</span><span class="p">,</span> <span class="s2">&quot;TransactionID&quot;</span><span class="p">,</span> <span class="s2">&quot;TransactionDT&quot;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">fraude_drop</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(590540, 199)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Se eliminarán también las filas que tengan más del 40% de datos faltantes</span>

<span class="n">porcentaje_faltantes_por_fila</span> <span class="o">=</span> <span class="p">(</span><span class="n">fraude_drop</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">fraude_drop</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">filas_a_eliminar</span> <span class="o">=</span> <span class="n">porcentaje_faltantes_por_fila</span><span class="p">[</span><span class="n">porcentaje_faltantes_por_fila</span> <span class="o">&gt;</span> <span class="mi">40</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">fraude_drop</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">filas_a_eliminar</span><span class="p">)</span>
<span class="n">fraude_drop</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Index: 522058 entries, 0 to 590539
Columns: 199 entries, isFraud to V321
dtypes: category(4), float16(175), float32(18), int16(1), int8(1)
memory usage: 217.6 MB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">chi2_contingency</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">columnas_categoricas</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">resultados_chi2</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">col1</span> <span class="ow">in</span> <span class="n">columnas_categoricas</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">col2</span> <span class="ow">in</span> <span class="n">columnas_categoricas</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">col1</span> <span class="o">!=</span> <span class="n">col2</span><span class="p">:</span>
            <span class="c1"># Crea una tabla de contingencia</span>
            <span class="n">tabla_contingencia</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">fraude_drop</span><span class="p">[</span><span class="n">col1</span><span class="p">],</span> <span class="n">fraude</span><span class="p">[</span><span class="n">col2</span><span class="p">])</span>
            
            <span class="c1"># Aplica la prueba de chi-cuadrado</span>
            <span class="n">chi2</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">dof</span><span class="p">,</span> <span class="n">expected</span> <span class="o">=</span> <span class="n">chi2_contingency</span><span class="p">(</span><span class="n">tabla_contingencia</span><span class="p">)</span>
            
            <span class="c1"># Almacena los resultados en el diccionario</span>
            <span class="n">resultados_chi2</span><span class="p">[(</span><span class="n">col1</span><span class="p">,</span> <span class="n">col2</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Chi2&#39;</span><span class="p">:</span> <span class="n">chi2</span><span class="p">,</span> <span class="s1">&#39;p-valor&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">,</span> <span class="s1">&#39;Grados de libertad&#39;</span><span class="p">:</span> <span class="n">dof</span><span class="p">,</span> <span class="s1">&#39;Frecuencias esperadas&#39;</span><span class="p">:</span> <span class="n">expected</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">columnas_relacionadas</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

<span class="c1"># Filtrar las columnas relacionadas con p-valor &lt; 0.05</span>
<span class="k">for</span> <span class="n">cols</span><span class="p">,</span> <span class="n">resultado</span> <span class="ow">in</span> <span class="n">resultados_chi2</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">resultado</span><span class="p">[</span><span class="s1">&#39;p-valor&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">:</span>
        <span class="n">columnas_relacionadas</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cols</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># Agrega la primera columna</span>
        <span class="n">columnas_relacionadas</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cols</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># Agrega la segunda columna</span>

<span class="c1"># Convertir el conjunto en una lista (si lo deseas)</span>
<span class="n">columnas_relacionadas</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">columnas_relacionadas</span><span class="p">)</span>

<span class="c1"># Imprimir las columnas relacionadas</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Columnas relacionadas con p-valor &lt; 0.05:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">columnas_relacionadas</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Columnas relacionadas con p-valor &lt; 0.05:
[&#39;ProductCD&#39;, &#39;M6&#39;, &#39;card6&#39;, &#39;card4&#39;]
</pre></div>
</div>
</div>
</div>
<p>Se eliminará la columna ProductCD y card6</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fraude_drop</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;ProductCD&quot;</span><span class="p">,</span> <span class="s2">&quot;M6&quot;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">columnas_categoricas</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">fraude_drop</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="n">columnas_categoricas</span><span class="p">)</span>
<span class="n">fraude_drop</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(520490, 197)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fraude_drop</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>V46               100272
V37               100272
V47               100272
V52               100272
V51               100272
                   ...  
C12                    0
C13                    0
C14                    0
TransactionAmt         0
isFraud                0
Length: 197, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Imputación de nulos con la mediana</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">SimpleImputer</span>

<span class="n">columnas_numericas</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">imputer</span> <span class="o">=</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;median&#39;</span><span class="p">)</span>

<span class="n">fraude_drop</span><span class="p">[</span><span class="n">columnas_numericas</span><span class="p">]</span> <span class="o">=</span> <span class="n">imputer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">fraude_drop</span><span class="p">[</span><span class="n">columnas_numericas</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fraude_drop</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>isFraud    0
V108       0
V110       0
V111       0
V112       0
          ..
V52        0
V53        0
V54        0
V55        0
V321       0
Length: 197, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">columnas_numericas</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="vif">
<h2>VIF<a class="headerlink" href="#vif" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.outliers_influence</span> <span class="kn">import</span> <span class="n">variance_inflation_factor</span>
</pre></div>
</div>
</div>
</div>
<p>Por tiempo computacional, haré el VIF por pedazos, si comparando menos variables dan VIF &gt; 5 con seguridad al hacerlo con todas las variables también será mayor que 5.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">columnas_v</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)]</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="p">[</span><span class="n">columnas_v</span><span class="p">[:</span><span class="mi">10</span><span class="p">]]</span>
<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Muestra el DataFrame con los resultados del VIF</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s2">&quot;VIF&quot;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Variable         VIF
5      V17  114.006015
6      V18  105.412715
3      V15   76.213446
4      V16   72.142285
7      V19   30.137431
8      V20   29.096228
1      V13   17.730436
0      V12   16.809984
9      V21   14.146751
2      V14    6.516514
</pre></div>
</div>
</div>
</div>
<p>En vista que los VIF son muy grandes eliminaré varios al mismo tiempo, porque deben tener relación con varias variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fraude_drop</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;V17&quot;</span><span class="p">,</span> <span class="s2">&quot;V18&quot;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">columnas_v</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)]</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="p">[</span><span class="n">columnas_v</span><span class="p">[:</span><span class="mi">10</span><span class="p">]]</span>
<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Muestra el DataFrame con los resultados del VIF</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s2">&quot;VIF&quot;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Variable        VIF
3      V15  56.094780
4      V16  51.826529
5      V19  30.141597
6      V20  29.093686
2      V14  23.204205
7      V21  22.028861
9      V23  19.075445
8      V22  18.036449
1      V13  17.733976
0      V12  16.809364
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fraude_drop</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;V15&quot;</span><span class="p">,</span> <span class="s2">&quot;V16&quot;</span><span class="p">,</span> <span class="s2">&quot;V19&quot;</span><span class="p">,</span> <span class="s2">&quot;V20&quot;</span><span class="p">,</span> <span class="s2">&quot;V14&quot;</span><span class="p">,</span> <span class="s2">&quot;V21&quot;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">columnas_v</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)]</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="p">[</span><span class="n">columnas_v</span><span class="p">[:</span><span class="mi">20</span><span class="p">]]</span>
<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Muestra el DataFrame con los resultados del VIF</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s2">&quot;VIF&quot;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Variable         VIF
5       V25  118.964844
6       V26  111.574957
11      V31   73.144561
12      V32   65.187499
3       V23   59.849234
4       V24   49.245343
16      V36   27.779070
15      V35   26.547462
13      V33   23.587404
1       V13   21.875335
9       V29   20.515290
0       V12   20.490388
10      V30   19.737683
14      V34   19.258825
7       V27   18.874107
8       V28   18.843776
17      V37   16.638578
18      V38   13.158047
2       V22    5.677836
19      V39    3.020775
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fraude_drop</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;V25&quot;</span><span class="p">,</span> <span class="s2">&quot;V26&quot;</span><span class="p">,</span> <span class="s2">&quot;V31&quot;</span><span class="p">,</span> <span class="s2">&quot;V32&quot;</span><span class="p">,</span> <span class="s2">&quot;V23&quot;</span><span class="p">,</span> <span class="s2">&quot;V24&quot;</span><span class="p">,</span> <span class="s2">&quot;V36&quot;</span><span class="p">,</span> <span class="s2">&quot;V35&quot;</span><span class="p">,</span> <span class="s2">&quot;V33&quot;</span><span class="p">,</span> <span class="s2">&quot;V13&quot;</span><span class="p">,</span> <span class="s2">&quot;V29&quot;</span><span class="p">,</span> <span class="s2">&quot;V12&quot;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">columnas_v</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)]</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="p">[</span><span class="n">columnas_v</span><span class="p">[:</span><span class="mi">20</span><span class="p">]]</span>
<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Muestra el DataFrame con los resultados del VIF</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s2">&quot;VIF&quot;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Variable         VIF
14      V46  150.910028
15      V47   79.461120
9       V41   62.579150
12      V44   42.449660
13      V45   36.287203
5       V37   35.489168
10      V42   31.329951
6       V38   29.299340
17      V49   25.273422
16      V48   24.973960
11      V43   24.767805
7       V39   19.787779
1       V27   18.829888
2       V28   18.820489
8       V40   17.025004
18      V50    9.998011
19      V51    9.764268
4       V34    6.360675
0       V22    3.689287
3       V30    3.606215
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fraude_drop</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;V46&quot;</span><span class="p">,</span> <span class="s2">&quot;V27&quot;</span><span class="p">,</span> <span class="s2">&quot;V41&quot;</span><span class="p">,</span> <span class="s2">&quot;V44&quot;</span><span class="p">,</span> <span class="s2">&quot;V45&quot;</span><span class="p">,</span> <span class="s2">&quot;V37&quot;</span><span class="p">,</span> <span class="s2">&quot;V42&quot;</span><span class="p">,</span> <span class="s2">&quot;V38&quot;</span><span class="p">,</span> <span class="s2">&quot;V49&quot;</span><span class="p">,</span> <span class="s2">&quot;V48&quot;</span><span class="p">,</span> <span class="s2">&quot;V43&quot;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">columnas_v</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)]</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="p">[</span><span class="n">columnas_v</span><span class="p">[:</span><span class="mi">30</span><span class="p">]]</span>
<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Muestra el DataFrame con los resultados del VIF</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s2">&quot;VIF&quot;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Variable         VIF
14      V57  261.750703
28      V71  260.712104
15      V58  256.596188
29      V72  250.168467
23      V66   89.121450
24      V67   73.036979
22      V65   58.188394
6       V47   41.614719
16      V59   36.703205
18      V61   33.062320
19      V62   31.338085
20      V63   29.599616
17      V60   28.046939
12      V55   26.210758
27      V70   24.621999
26      V69   23.179053
8       V51   21.346861
21      V64   19.854561
9       V52   18.971438
11      V54   18.831156
4       V39   18.376690
13      V56   17.598262
10      V53   17.554736
5       V40   16.084842
7       V50   10.421921
2       V30    8.101184
3       V34    7.034961
0       V22    5.032858
25      V68    1.532684
1       V28    1.523874
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fraude_drop</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;V57&quot;</span><span class="p">,</span> <span class="s2">&quot;V71&quot;</span><span class="p">,</span> <span class="s2">&quot;V58&quot;</span><span class="p">,</span> <span class="s2">&quot;V72&quot;</span><span class="p">,</span> <span class="s2">&quot;V66&quot;</span><span class="p">,</span> <span class="s2">&quot;V67&quot;</span><span class="p">,</span> <span class="s2">&quot;V65&quot;</span><span class="p">,</span> <span class="s2">&quot;V47&quot;</span><span class="p">,</span> <span class="s2">&quot;V59&quot;</span><span class="p">,</span> <span class="s2">&quot;V61&quot;</span><span class="p">,</span> <span class="s2">&quot;V62&quot;</span><span class="p">,</span> <span class="s2">&quot;V63&quot;</span><span class="p">,</span> <span class="s2">&quot;V60&quot;</span><span class="p">,</span> <span class="s2">&quot;V55&quot;</span><span class="p">,</span> <span class="s2">&quot;V70&quot;</span><span class="p">,</span> <span class="s2">&quot;V69&quot;</span><span class="p">,</span> <span class="s2">&quot;V51&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;V64&quot;</span><span class="p">,</span> <span class="s2">&quot;V52&quot;</span><span class="p">,</span> <span class="s2">&quot;V54&quot;</span><span class="p">,</span> <span class="s2">&quot;V39&quot;</span><span class="p">,</span><span class="s2">&quot;V56&quot;</span><span class="p">,</span> <span class="s2">&quot;V53&quot;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">columnas_v</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)]</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="p">[</span><span class="n">columnas_v</span><span class="p">[:</span><span class="mi">30</span><span class="p">]]</span>
<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Muestra el DataFrame con los resultados del VIF</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s2">&quot;VIF&quot;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Variable        VIF
27      V93  52.176473
26      V92  48.428655
20      V86  38.895659
16      V82  31.251188
18      V84  30.939438
17      V83  29.972725
21      V87  28.160665
11      V77  27.329466
19      V85  26.386106
14      V80  25.038514
15      V81  24.203767
25      V91  24.077816
24      V90  21.923129
12      V78  21.289963
28      V94  20.941186
7       V73  20.061382
13      V79  18.015679
10      V76  17.043956
9       V75  15.886139
22      V88  15.645462
8       V74  14.739767
5       V50  12.620375
2       V30   8.799873
3       V34   8.738561
4       V40   5.165317
0       V22   4.946166
23      V89   3.021583
1       V28   2.639712
6       V68   1.752818
29      V95   1.058829
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fraude_drop</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;V93&quot;</span><span class="p">,</span> <span class="s2">&quot;V92&quot;</span><span class="p">,</span> <span class="s2">&quot;V86&quot;</span><span class="p">,</span> <span class="s2">&quot;V82&quot;</span><span class="p">,</span> <span class="s2">&quot;V84&quot;</span><span class="p">,</span> <span class="s2">&quot;V83&quot;</span><span class="p">,</span> <span class="s2">&quot;V87&quot;</span><span class="p">,</span> <span class="s2">&quot;V77&quot;</span><span class="p">,</span> <span class="s2">&quot;V85&quot;</span><span class="p">,</span> <span class="s2">&quot;V80&quot;</span><span class="p">,</span> <span class="s2">&quot;V81&quot;</span><span class="p">,</span> <span class="s2">&quot;V91&quot;</span><span class="p">,</span> <span class="s2">&quot;V90&quot;</span><span class="p">,</span> <span class="s2">&quot;V78&quot;</span><span class="p">,</span> <span class="s2">&quot;V94&quot;</span><span class="p">,</span> <span class="s2">&quot;V73&quot;</span><span class="p">,</span> <span class="s2">&quot;V79&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;V76&quot;</span><span class="p">,</span> <span class="s2">&quot;V75&quot;</span><span class="p">,</span> <span class="s2">&quot;V88&quot;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">columnas_v</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)]</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="p">[</span><span class="n">columnas_v</span><span class="p">[:</span><span class="mi">20</span><span class="p">]]</span>
<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Muestra el DataFrame con los resultados del VIF</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s2">&quot;VIF&quot;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Variable           VIF
10      V96  7.876574e+06
16     V102  6.262711e+06
9       V95  2.785484e+06
15     V101  2.665999e+06
19     V105  5.522655e+04
13      V99  3.837525e+04
11      V97  9.263334e+03
17     V103  8.923249e+03
18     V104  2.480760e+03
12      V98  5.083347e+02
14     V100  1.710654e+01
5       V50  6.301908e+00
3       V34  6.194983e+00
7       V74  5.221004e+00
0       V22  3.485150e+00
4       V40  2.974950e+00
8       V89  2.974178e+00
1       V28  2.633228e+00
6       V68  1.752908e+00
2       V30  1.049954e+00
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fraude_drop</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;V96&quot;</span><span class="p">,</span> <span class="s2">&quot;V102&quot;</span><span class="p">,</span> <span class="s2">&quot;V95&quot;</span><span class="p">,</span> <span class="s2">&quot;V101&quot;</span><span class="p">,</span> <span class="s2">&quot;V105&quot;</span><span class="p">,</span> <span class="s2">&quot;V99&quot;</span><span class="p">,</span> <span class="s2">&quot;V97&quot;</span><span class="p">,</span> <span class="s2">&quot;V103&quot;</span><span class="p">,</span> <span class="s2">&quot;V104&quot;</span><span class="p">,</span> <span class="s2">&quot;V98&quot;</span><span class="p">,</span> <span class="s2">&quot;V100&quot;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">columnas_v</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)]</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="p">[</span><span class="n">columnas_v</span><span class="p">[:</span><span class="mi">20</span><span class="p">]]</span>
<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Muestra el DataFrame con los resultados del VIF</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s2">&quot;VIF&quot;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Variable          VIF
16     V113  1779.255032
14     V111  1641.017613
11     V108  1001.551845
13     V110   820.501910
15     V112   527.403654
17     V114   482.058293
19     V116   396.803018
12     V109   233.227568
10     V107   218.703063
18     V115   104.806118
5       V50     6.319880
3       V34     6.201719
7       V74     5.247359
0       V22     3.471043
4       V40     3.016343
8       V89     2.972140
1       V28     2.630712
6       V68     1.752066
2       V30     1.681470
9      V106     1.068827
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fraude_drop</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;V113&quot;</span><span class="p">,</span> <span class="s2">&quot;V111&quot;</span><span class="p">,</span> <span class="s2">&quot;V108&quot;</span><span class="p">,</span> <span class="s2">&quot;V110&quot;</span><span class="p">,</span> <span class="s2">&quot;V112&quot;</span><span class="p">,</span> <span class="s2">&quot;V114&quot;</span><span class="p">,</span> <span class="s2">&quot;V109&quot;</span><span class="p">,</span> <span class="s2">&quot;V107&quot;</span><span class="p">,</span> <span class="s2">&quot;V115&quot;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">columnas_v</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)]</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="p">[</span><span class="n">columnas_v</span><span class="p">[:</span><span class="mi">30</span><span class="p">]]</span>
<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Muestra el DataFrame con los resultados del VIF</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s2">&quot;VIF&quot;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Variable           VIF
20     V126  29074.290406
26     V132  27517.217607
13     V119   5778.123962
11     V117   4918.257448
22     V128   3129.707542
28     V134   2869.927191
14     V120   2337.736060
21     V127   2159.900375
16     V122   2116.403469
27     V133   2036.012233
12     V118   1630.817598
15     V121    510.391180
29     V135    314.583637
19     V125    103.631530
10     V116     94.940860
17     V123     80.583365
23     V129     68.488854
18     V124     27.550033
24     V130     17.963857
25     V131     16.127923
9      V106      7.962492
5       V50      6.345851
3       V34      6.205324
7       V74      5.250541
0       V22      3.476461
4       V40      3.028847
8       V89      3.021918
1       V28      2.679774
6       V68      1.825989
2       V30      1.695702
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fraude_drop</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;V126&quot;</span><span class="p">,</span> <span class="s2">&quot;V132&quot;</span><span class="p">,</span> <span class="s2">&quot;V119&quot;</span><span class="p">,</span> <span class="s2">&quot;V117&quot;</span><span class="p">,</span> <span class="s2">&quot;V128&quot;</span><span class="p">,</span> <span class="s2">&quot;V134&quot;</span><span class="p">,</span> <span class="s2">&quot;V120&quot;</span><span class="p">,</span> <span class="s2">&quot;V127&quot;</span><span class="p">,</span> <span class="s2">&quot;V122&quot;</span><span class="p">,</span> <span class="s2">&quot;V133&quot;</span><span class="p">,</span> <span class="s2">&quot;V118&quot;</span><span class="p">,</span> <span class="s2">&quot;V121&quot;</span><span class="p">,</span> <span class="s2">&quot;V135&quot;</span><span class="p">,</span> <span class="s2">&quot;V125&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;V125&quot;</span><span class="p">,</span> <span class="s2">&quot;V116&quot;</span><span class="p">,</span> <span class="s2">&quot;V123&quot;</span><span class="p">,</span> <span class="s2">&quot;V129&quot;</span><span class="p">,</span> <span class="s2">&quot;V124&quot;</span><span class="p">,</span> <span class="s2">&quot;V130&quot;</span><span class="p">,</span> <span class="s2">&quot;V131&quot;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">columnas_v</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)]</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="p">[</span><span class="n">columnas_v</span><span class="p">[:</span><span class="mi">30</span><span class="p">]]</span>
<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Muestra el DataFrame con los resultados del VIF</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s2">&quot;VIF&quot;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Variable           VIF
13     V280  12137.147050
28     V295  10804.621296
12     V279   8550.326274
26     V293   8388.766211
27     V294    103.563381
24     V291     35.117359
10     V136     29.703062
9      V106     28.603410
25     V292     27.162614
20     V287     26.631344
11     V137     17.607969
29     V296     16.257807
22     V289      7.453304
21     V288      7.156230
23     V290      6.713951
5       V50      6.505183
3       V34      6.254060
7       V74      5.512292
15     V282      5.086767
17     V284      4.994006
18     V285      4.081380
16     V283      3.824424
0       V22      3.510494
4       V40      2.988340
8       V89      2.980756
1       V28      2.640102
14     V281      2.059950
6       V68      1.768803
19     V286      1.603774
2       V30      1.499791
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">columnas_alto_vif</span> <span class="o">=</span> <span class="n">vif_data</span><span class="p">[</span><span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">][</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">fraude_drop</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columnas_alto_vif</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">columnas_v</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)]</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="p">[</span><span class="n">columnas_v</span><span class="p">[:</span><span class="mi">30</span><span class="p">]]</span>
<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Muestra el DataFrame con los resultados del VIF</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s2">&quot;VIF&quot;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Variable         VIF
21     V298  100.779835
19     V296   67.130967
27     V304   27.956360
22     V299   24.793782
25     V302   18.532886
26     V303   10.035327
20     V297    7.553293
17     V289    7.432598
16     V288    7.227926
5       V50    6.732683
3       V34    6.496506
11     V282    6.446928
23     V300    5.960248
24     V301    5.650496
7       V74    5.611351
28     V305    5.565708
0       V22    4.723079
18     V290    3.995026
12     V283    3.833811
4       V40    3.555848
29     V306    3.332527
8       V89    2.976927
1       V28    2.633827
10     V281    2.363107
13     V284    2.129152
9      V137    1.782693
6       V68    1.764811
2       V30    1.735553
14     V285    1.734551
15     V286    1.598491
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">columnas_alto_vif</span> <span class="o">=</span> <span class="n">vif_data</span><span class="p">[</span><span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">][</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">fraude_drop</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columnas_alto_vif</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">columnas_v</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)]</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="p">[</span><span class="n">columnas_v</span><span class="p">[:</span><span class="mi">40</span><span class="p">]]</span>
<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Muestra el DataFrame con los resultados del VIF</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s2">&quot;VIF&quot;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Variable           VIF
25     V306  27360.958969
35     V316  25883.085955
26     V307  12617.450963
36     V317  10470.846840
27     V308   2520.891487
37     V318   2243.090033
38     V319    319.501192
29     V310     96.055742
39     V320     94.314907
28     V309     72.741645
34     V315     14.907154
31     V312     14.394491
17     V289     11.121462
32     V313     10.717797
16     V288     10.039460
22     V302      9.514532
9      V137      8.485686
5       V50      6.766992
11     V282      6.533918
3       V34      6.497439
24     V305      6.458649
30     V311      6.431564
23     V303      6.305890
20     V300      5.957494
18     V290      5.674463
21     V301      5.672836
7       V74      5.640645
0       V22      4.736203
33     V314      4.397176
12     V283      3.845217
4       V40      3.493602
19     V297      3.363571
14     V285      3.121140
13     V284      3.086205
8       V89      3.081638
1       V28      2.677198
10     V281      2.383682
15     V286      1.928344
6       V68      1.875160
2       V30      1.754510
</pre></div>
</div>
</div>
</div>
<p>Fui modificanado el umbral al notar que en su mayoría las variables siguen relacionandose entre sí</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">columnas_alto_vif</span> <span class="o">=</span> <span class="n">vif_data</span><span class="p">[</span><span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">][</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">fraude_drop</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columnas_alto_vif</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">columnas_v</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)]</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="p">[</span><span class="n">columnas_v</span><span class="p">[:</span><span class="mi">30</span><span class="p">]]</span>
<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Muestra el DataFrame con los resultados del VIF</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s2">&quot;VIF&quot;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Variable       VIF
20     V302  8.871147
25     V321  8.146987
9      V137  8.031460
5       V50  6.701094
3       V34  6.474425
11     V282  5.925031
18     V300  5.813666
19     V301  5.613493
7       V74  5.565215
22     V305  5.518826
21     V303  5.496257
0       V22  4.700767
16     V290  3.731760
4       V40  3.473447
8       V89  2.977621
12     V283  2.943345
1       V28  2.635160
10     V281  2.303433
13     V284  2.085752
17     V297  2.084991
6       V68  1.769674
2       V30  1.729920
15     V286  1.644873
14     V285  1.638984
24     V314  1.282311
23     V311  1.086873
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fraude_drop</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;V302&quot;</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">columnas_v</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)]</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="p">[</span><span class="n">columnas_v</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">columnas_v</span><span class="p">)]]</span>
<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Muestra el DataFrame con los resultados del VIF</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s2">&quot;VIF&quot;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Variable       VIF
24     V321  8.146908
9      V137  8.029641
5       V50  6.482280
3       V34  6.351998
11     V282  5.899619
18     V300  5.813782
19     V301  5.613422
7       V74  5.525488
21     V305  5.472453
0       V22  4.080313
16     V290  3.656912
20     V303  3.298147
4       V40  3.243489
8       V89  2.974400
12     V283  2.942489
1       V28  2.635095
10     V281  2.299862
13     V284  2.083581
17     V297  2.082682
6       V68  1.768985
2       V30  1.728375
15     V286  1.644532
14     V285  1.636652
23     V314  1.280431
22     V311  1.086840
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fraude_drop</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;V321&quot;</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">columnas_v</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)]</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="p">[</span><span class="n">columnas_v</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">columnas_v</span><span class="p">)]]</span>
<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Muestra el DataFrame con los resultados del VIF</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s2">&quot;VIF&quot;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Variable       VIF
5       V50  6.481632
3       V34  6.351998
11     V282  5.899553
18     V300  5.792209
19     V301  5.611375
7       V74  5.525442
21     V305  5.464105
0       V22  4.080146
16     V290  3.644801
20     V303  3.292294
4       V40  3.243010
8       V89  2.974163
12     V283  2.942498
1       V28  2.633762
10     V281  2.299478
13     V284  2.083575
17     V297  2.047968
6       V68  1.768601
2       V30  1.728373
9      V137  1.654357
15     V286  1.644522
14     V285  1.636608
23     V314  1.280320
22     V311  1.086840
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fraude_drop</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;V50&quot;</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">columnas_v</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)]</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="p">[</span><span class="n">columnas_v</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">columnas_v</span><span class="p">)]]</span>
<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Muestra el DataFrame con los resultados del VIF</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s2">&quot;VIF&quot;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Variable       VIF
10     V282  5.886851
3       V34  5.822359
17     V300  5.791899
18     V301  5.611383
20     V305  5.454727
6       V74  5.222301
0       V22  3.820407
15     V290  3.640034
19     V303  3.285713
7       V89  2.974114
11     V283  2.928800
4       V40  2.774156
1       V28  2.632291
9      V281  2.287698
12     V284  2.081855
16     V297  2.043737
5       V68  1.768599
2       V30  1.723109
8      V137  1.654318
14     V286  1.641571
13     V285  1.631435
22     V314  1.279134
21     V311  1.086810
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fraude_drop</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;V282&quot;</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">columnas_v</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)]</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="p">[</span><span class="n">columnas_v</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">columnas_v</span><span class="p">)]]</span>
<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Muestra el DataFrame con los resultados del VIF</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s2">&quot;VIF&quot;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Variable       VIF
3       V34  5.822234
17     V301  5.568712
16     V300  5.454413
6       V74  5.217610
19     V305  4.474718
0       V22  3.813184
14     V290  3.640063
18     V303  3.284319
7       V89  2.973990
4       V40  2.771441
1       V28  2.632300
10     V283  2.125561
11     V284  2.081338
15     V297  2.036128
5       V68  1.768397
2       V30  1.709791
8      V137  1.653530
13     V286  1.641547
9      V281  1.625230
12     V285  1.553102
21     V314  1.278610
20     V311  1.086811
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fraude_drop</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;V34&quot;</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">columnas_v</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)]</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="p">[</span><span class="n">columnas_v</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">columnas_v</span><span class="p">)]]</span>
<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Muestra el DataFrame con los resultados del VIF</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s2">&quot;VIF&quot;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Variable       VIF
16     V301  5.568385
15     V300  5.453891
18     V305  4.474225
13     V290  3.591515
0       V22  3.251691
17     V303  3.225200
6       V89  2.973989
3       V40  2.749771
5       V74  2.687748
1       V28  2.630182
9      V283  2.122953
10     V284  2.081295
14     V297  2.035933
4       V68  1.768397
2       V30  1.705217
7      V137  1.653517
12     V286  1.641479
8      V281  1.623601
11     V285  1.552020
20     V314  1.278524
19     V311  1.086811
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fraude_drop</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;V301&quot;</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">columnas_v</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)]</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="p">[</span><span class="n">columnas_v</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">columnas_v</span><span class="p">)]]</span>
<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Muestra el DataFrame con los resultados del VIF</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s2">&quot;VIF&quot;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Variable       VIF
17     V305  4.472604
13     V290  3.591403
0       V22  3.251488
16     V303  3.223046
6       V89  2.973988
3       V40  2.749766
5       V74  2.687601
1       V28  2.630176
10     V284  2.081175
9      V283  2.075950
14     V297  2.028124
4       V68  1.768382
2       V30  1.705193
7      V137  1.652329
12     V286  1.641471
8      V281  1.621407
11     V285  1.551900
19     V314  1.277473
15     V300  1.190223
18     V311  1.086797
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">columnas_numericas</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="p">[</span><span class="n">columnas_numericas</span><span class="p">]</span>
<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Muestra el DataFrame con los resultados del VIF</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s2">&quot;VIF&quot;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          Variable          VIF
19             C12  4765.861520
14              C7  3166.771062
18             C11  2211.765288
15              C8  2072.135117
43            V305  1761.938112
7            addr2  1312.977080
11              C4   809.203644
17             C10   628.661043
13              C6   565.858760
8               C1   543.145636
9               C2   376.872546
21             C14   342.322192
4            card3   339.129555
16              C9    71.110463
20             C13    59.613793
5            card5    26.097263
12              C5    19.231437
6            addr1    10.350879
3            card2     6.393660
2            card1     5.197298
25             D15     4.660114
39            V290     3.653427
26             V22     3.547110
42            V303     3.441285
31             V74     3.294549
32             V89     3.124694
24             D10     3.117558
22              D1     2.827216
29             V40     2.822383
27             V28     2.709061
23              D4     2.560756
35            V283     2.314583
36            V284     2.088722
40            V297     2.062279
37            V285     2.031116
28             V30     1.875457
30             V68     1.818607
33            V137     1.683644
38            V286     1.645385
34            V281     1.635061
10              C3     1.622035
1   TransactionAmt     1.417560
45            V314     1.317738
41            V300     1.199944
0          isFraud     1.127447
44            V311     1.089460
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fraude_drop</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;C12&quot;</span><span class="p">,</span><span class="s2">&quot;C11&quot;</span><span class="p">,</span><span class="s2">&quot;C7&quot;</span><span class="p">,</span> <span class="s2">&quot;C8&quot;</span><span class="p">,</span> <span class="s2">&quot;V305&quot;</span><span class="p">,</span> <span class="s2">&quot;addr2&quot;</span><span class="p">,</span> <span class="s2">&quot;C4&quot;</span><span class="p">,</span> <span class="s2">&quot;C10&quot;</span><span class="p">,</span> <span class="s2">&quot;C6&quot;</span><span class="p">,</span> <span class="s2">&quot;C1&quot;</span><span class="p">,</span> <span class="s2">&quot;C2&quot;</span><span class="p">,</span> <span class="s2">&quot;C14&quot;</span><span class="p">,</span> <span class="s2">&quot;card3&quot;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">columnas_numericas</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="p">[</span><span class="n">columnas_numericas</span><span class="p">]</span>
<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Muestra el DataFrame con los resultados del VIF</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s2">&quot;VIF&quot;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          Variable        VIF
4            card5  12.688306
5            addr1   8.739054
7               C5   7.959630
8               C9   7.794932
3            card2   5.873060
13             D15   4.559896
2            card1   4.548607
27            V290   3.514512
14             V22   3.328565
30            V303   3.243224
20             V89   3.124533
12             D10   3.090576
17             V40   2.783468
10              D1   2.752213
19             V74   2.744637
15             V28   2.708382
11              D4   2.550267
9              C13   2.444077
23            V283   2.280569
24            V284   2.085132
28            V297   2.047302
16             V30   1.839211
18             V68   1.818562
21            V137   1.682001
26            V286   1.644897
25            V285   1.638892
22            V281   1.624878
6               C3   1.621627
1   TransactionAmt   1.402684
32            V314   1.311685
29            V300   1.196247
0          isFraud   1.093418
31            V311   1.089373
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fraude_drop</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;card5&quot;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">columnas_numericas</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="p">[</span><span class="n">columnas_numericas</span><span class="p">]</span>
<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Muestra el DataFrame con los resultados del VIF</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s2">&quot;VIF&quot;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          Variable       VIF
6               C5  7.950920
7               C9  7.786774
4            addr1  6.566735
3            card2  5.119765
12             D15  4.540236
2            card1  4.309856
26            V290  3.361815
13             V22  3.323207
29            V303  3.212212
19             V89  3.124482
11             D10  3.089481
16             V40  2.782418
9               D1  2.745727
18             V74  2.744480
14             V28  2.708362
10              D4  2.548360
8              C13  2.444058
22            V283  2.259199
23            V284  2.085085
27            V297  2.042036
17             V68  1.818545
15             V30  1.814444
20            V137  1.681572
25            V286  1.644870
24            V285  1.627337
5               C3  1.621605
21            V281  1.616918
1   TransactionAmt  1.391924
31            V314  1.311676
28            V300  1.196160
0          isFraud  1.092953
30            V311  1.089360
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fraude_drop</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;C5&quot;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">columnas_numericas</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="p">[</span><span class="n">columnas_numericas</span><span class="p">]</span>
<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Muestra el DataFrame con los resultados del VIF</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s2">&quot;VIF&quot;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          Variable       VIF
4            addr1  6.561676
3            card2  5.118116
11             D15  4.540233
2            card1  4.308917
25            V290  3.361569
12             V22  3.314065
28            V303  3.212206
18             V89  3.124477
10             D10  3.088439
15             V40  2.781831
8               D1  2.745080
17             V74  2.743533
13             V28  2.708345
9               D4  2.547787
6               C9  2.345002
7              C13  2.280307
21            V283  2.259025
22            V284  2.085070
26            V297  2.041981
16             V68  1.818544
14             V30  1.796801
19            V137  1.681563
24            V286  1.644638
23            V285  1.622963
5               C3  1.621604
20            V281  1.616900
1   TransactionAmt  1.391768
30            V314  1.311674
27            V300  1.196103
0          isFraud  1.092915
29            V311  1.089360
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fraude_drop</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;addr1&quot;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">columnas_numericas</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="p">[</span><span class="n">columnas_numericas</span><span class="p">]</span>
<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Muestra el DataFrame con los resultados del VIF</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s2">&quot;VIF&quot;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          Variable       VIF
10             D15  4.520727
3            card2  4.219243
2            card1  3.763409
11             V22  3.292366
24            V290  3.214251
27            V303  3.194739
17             V89  3.124421
9              D10  3.086589
14             V40  2.781502
7               D1  2.742882
16             V74  2.737675
12             V28  2.708285
8               D4  2.546589
5               C9  2.344973
6              C13  2.280296
20            V283  2.236503
21            V284  2.085047
25            V297  2.041838
15             V68  1.818472
13             V30  1.764147
18            V137  1.681555
23            V286  1.644560
22            V285  1.622192
4               C3  1.621604
19            V281  1.609884
1   TransactionAmt  1.382141
29            V314  1.311389
26            V300  1.195774
0          isFraud  1.091903
28            V311  1.089357
</pre></div>
</div>
</div>
</div>
<p>Correlación de variables</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">columnas_numericas</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1">#Quitar la columna de la variable respuesta del cálculo del VIF</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="p">[</span><span class="n">columnas_numericas</span><span class="p">]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;isFraud&quot;</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">corr</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">corr</span><span class="p">)</span>
<span class="n">mask</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">tril_indices_from</span><span class="p">(</span><span class="n">mask</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">font_scale</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="n">mask</span> <span class="o">=</span> <span class="n">mask</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;.1f&#39;</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">annot_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">},</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="_images/f2777f4cfc5868abc146e0b750d21b5f1ad66367b4be0432cfe13595eb821524.png" src="_images/f2777f4cfc5868abc146e0b750d21b5f1ad66367b4be0432cfe13595eb821524.png" />
</div>
</div>
<p>Se eliminarán las columnas V89, V22, C3, D15, C9, V74 porque tienen una correlación grande entre variables, esto implica que pueden ser explicadas por otras variables  y se convierte en información redundante.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fraude_drop</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;V89&quot;</span><span class="p">,</span> <span class="s2">&quot;V22&quot;</span><span class="p">,</span> <span class="s2">&quot;C3&quot;</span><span class="p">,</span> <span class="s2">&quot;D15&quot;</span><span class="p">,</span> <span class="s2">&quot;C9&quot;</span><span class="p">,</span> <span class="s2">&quot;V74&quot;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">columnas_numericas</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1">#Quitar la columna de la variable respuesta del cálculo del VIF</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">fraude_drop</span><span class="p">[</span><span class="n">columnas_numericas</span><span class="p">]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;isFraud&quot;</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">corr</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">corr</span><span class="p">)</span>
<span class="n">mask</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">tril_indices_from</span><span class="p">(</span><span class="n">mask</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">font_scale</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="n">mask</span> <span class="o">=</span> <span class="n">mask</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;.1f&#39;</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">annot_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">},</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="_images/2a6ec972ae49f7a74eccea6988fac4dd089094d29515bd31e0a03b2d1a252e7f.png" src="_images/2a6ec972ae49f7a74eccea6988fac4dd089094d29515bd31e0a03b2d1a252e7f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fraude_final</span> <span class="o">=</span> <span class="n">fraude_drop</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fraude_final</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(520490, 26)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fraude_final</span><span class="p">[</span><span class="s2">&quot;isFraud&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>isFraud
0.0    503155
1.0     17335
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Por temas de procesamiento, tomaré para entrenar los modelos solo el 15% de los datos que no son fraude.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fraude_no_fraude</span> <span class="o">=</span> <span class="n">fraude_final</span><span class="p">[</span><span class="n">fraude_final</span><span class="p">[</span><span class="s2">&quot;isFraud&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">mitad_aleatoria</span> <span class="o">=</span> <span class="n">fraude_no_fraude</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> 

<span class="n">fraude_si_fraude</span> <span class="o">=</span> <span class="n">fraude_final</span><span class="p">[</span><span class="n">fraude_final</span><span class="p">[</span><span class="s2">&quot;isFraud&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">fraude_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">mitad_aleatoria</span><span class="p">,</span> <span class="n">fraude_si_fraude</span><span class="p">])</span>
<span class="n">fraude_final</span><span class="p">[</span><span class="s2">&quot;isFraud&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>isFraud
0.0    75473
1.0    17335
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Esta selección de datos permite contrarestar el desbalance observado en la muestra original de datos.</p>
<p>Se aplica OneHotEncoding a los datos categóricos</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">columnas_categoricas</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;card4&#39;, &#39;card6&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fraude_final</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(92808, 26)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">one_hot_encode</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">columns</span><span class="p">):</span>
 
    <span class="n">encoder</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span>
    <span class="n">encoded_data</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">columns</span><span class="p">])</span>

    <span class="n">encoded_columns</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>

    <span class="n">df_encoded</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">encoded_data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">encoded_columns</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

    <span class="n">df_encoded</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">),</span> <span class="n">df_encoded</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">df_encoded</span>

<span class="n">fraude_encoded_def</span> <span class="o">=</span> <span class="n">one_hot_encode</span><span class="p">(</span><span class="n">fraude_final</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;card4&quot;</span><span class="p">,</span> <span class="s2">&quot;card6&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fraude_encoded_def</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(92808, 30)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_fraude</span> <span class="o">=</span> <span class="n">fraude_encoded_def</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_fraude</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;df_fraude.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualizacion">
<h2>Visualización<a class="headerlink" href="#visualizacion" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frecuencias</span> <span class="o">=</span> <span class="n">df_fraude</span><span class="p">[</span><span class="s1">&#39;isFraud&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="s1">&#39;No Fraude&#39;</span><span class="p">,</span> <span class="s1">&#39;Fraude&#39;</span><span class="p">],</span> <span class="n">frecuencias</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> 

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Clase de Fraude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Gráfico de Frecuencia de isFraud&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f7617978ae3e979f613ddba8f77a25064a3298f901f580aa27e043153d3cdabf.png" src="_images/f7617978ae3e979f613ddba8f77a25064a3298f901f580aa27e043153d3cdabf.png" />
</div>
</div>
<p>Se observa un desbalanceo en los datos, como es de esperarse en temas relacionados con fraude, puesto que es mucho más común la existencia de transacciones legítimas que de fraude.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_fraude</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>isFraud</th>
      <td>92808.0</td>
      <td>0.186783</td>
      <td>0.389740</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>0.000000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>TransactionAmt</th>
      <td>92808.0</td>
      <td>138.483932</td>
      <td>242.040924</td>
      <td>0.291992</td>
      <td>39.0</td>
      <td>67.0625</td>
      <td>117.046875</td>
      <td>5276.0</td>
    </tr>
    <tr>
      <th>card1</th>
      <td>92808.0</td>
      <td>9854.734375</td>
      <td>4858.893066</td>
      <td>1000.000000</td>
      <td>6019.0</td>
      <td>9633.0000</td>
      <td>14053.000000</td>
      <td>18395.0</td>
    </tr>
    <tr>
      <th>card2</th>
      <td>92808.0</td>
      <td>358.662109</td>
      <td>155.936768</td>
      <td>100.000000</td>
      <td>206.0</td>
      <td>360.0000</td>
      <td>500.000000</td>
      <td>600.0</td>
    </tr>
    <tr>
      <th>C13</th>
      <td>92808.0</td>
      <td>34.128296</td>
      <td>142.445572</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>3.0000</td>
      <td>13.000000</td>
      <td>2916.0</td>
    </tr>
    <tr>
      <th>D1</th>
      <td>92808.0</td>
      <td>95.104897</td>
      <td>156.935852</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>7.0000</td>
      <td>123.000000</td>
      <td>640.0</td>
    </tr>
    <tr>
      <th>D4</th>
      <td>92808.0</td>
      <td>109.815422</td>
      <td>172.241333</td>
      <td>-122.000000</td>
      <td>0.0</td>
      <td>26.0000</td>
      <td>141.000000</td>
      <td>838.0</td>
    </tr>
    <tr>
      <th>D10</th>
      <td>92808.0</td>
      <td>111.204010</td>
      <td>176.041428</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>7.0000</td>
      <td>158.000000</td>
      <td>865.0</td>
    </tr>
    <tr>
      <th>V28</th>
      <td>92808.0</td>
      <td>0.000679</td>
      <td>0.028038</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>0.000000</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>V30</th>
      <td>92808.0</td>
      <td>0.348052</td>
      <td>0.533745</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>1.000000</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>V40</th>
      <td>92808.0</td>
      <td>0.221134</td>
      <td>0.627426</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>0.000000</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>V68</th>
      <td>92808.0</td>
      <td>0.000366</td>
      <td>0.019692</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>0.000000</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>V137</th>
      <td>92808.0</td>
      <td>26.651266</td>
      <td>270.269165</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>0.000000</td>
      <td>30250.0</td>
    </tr>
    <tr>
      <th>V281</th>
      <td>92808.0</td>
      <td>0.130808</td>
      <td>0.651664</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>0.000000</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>V283</th>
      <td>92808.0</td>
      <td>1.116682</td>
      <td>1.937730</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>1.0000</td>
      <td>1.000000</td>
      <td>68.0</td>
    </tr>
    <tr>
      <th>V284</th>
      <td>92808.0</td>
      <td>0.107318</td>
      <td>0.368217</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>0.000000</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>V285</th>
      <td>92808.0</td>
      <td>1.277164</td>
      <td>3.276984</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>1.000000</td>
      <td>94.0</td>
    </tr>
    <tr>
      <th>V286</th>
      <td>92808.0</td>
      <td>0.034534</td>
      <td>0.197234</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>0.000000</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>V290</th>
      <td>92808.0</td>
      <td>1.136992</td>
      <td>0.916917</td>
      <td>1.000000</td>
      <td>1.0</td>
      <td>1.0000</td>
      <td>1.000000</td>
      <td>56.0</td>
    </tr>
    <tr>
      <th>V297</th>
      <td>92808.0</td>
      <td>0.086523</td>
      <td>0.628563</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>0.000000</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>V300</th>
      <td>92808.0</td>
      <td>0.040471</td>
      <td>0.265622</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>0.000000</td>
      <td>11.0</td>
    </tr>
    <tr>
      <th>V303</th>
      <td>92808.0</td>
      <td>0.255732</td>
      <td>0.661335</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>0.000000</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>V311</th>
      <td>92808.0</td>
      <td>4.248521</td>
      <td>48.590698</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>0.000000</td>
      <td>3162.0</td>
    </tr>
    <tr>
      <th>V314</th>
      <td>92808.0</td>
      <td>54.939171</td>
      <td>204.278885</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>0.000000</td>
      <td>7520.0</td>
    </tr>
    <tr>
      <th>card4_discover</th>
      <td>92808.0</td>
      <td>0.011551</td>
      <td>0.106852</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>0.000000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>card4_mastercard</th>
      <td>92808.0</td>
      <td>0.331965</td>
      <td>0.470921</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>1.000000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>card4_visa</th>
      <td>92808.0</td>
      <td>0.653661</td>
      <td>0.475805</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>1.0000</td>
      <td>1.000000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>card6_credit</th>
      <td>92808.0</td>
      <td>0.246681</td>
      <td>0.431082</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>0.000000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>card6_debit</th>
      <td>92808.0</td>
      <td>0.753276</td>
      <td>0.431107</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>1.0000</td>
      <td>1.000000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>card6_debit or credit</th>
      <td>92808.0</td>
      <td>0.000011</td>
      <td>0.003283</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>0.000000</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>En el 75% de los casos no se cometió fraude en las transacciones.</p></li>
<li><p>En promedio las transacciones tienen valor de 139, sin embargo, esto presenta una gran desviación (240) y valor máximo bien atípico (5192).</p></li>
<li><p>La card 1 presenta valores más grandes de promedio, cuartiles más grandes que la card2.</p></li>
<li><p>En la mayoría de las V los valores más frecuentes son 0.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">count_card4</span> <span class="o">=</span> <span class="n">fraude_final</span><span class="p">[</span><span class="s1">&#39;card4&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">count_card6</span> <span class="o">=</span> <span class="n">fraude_final</span><span class="p">[</span><span class="s1">&#39;card6&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">count_card4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribución de card4&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;card4&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">count_card6</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;salmon&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribución de card6&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;card6&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/dc16b89e497df6af89818f05e145cb445d0ba340b926a4523ccc71c5ee5c72be.png" src="_images/dc16b89e497df6af89818f05e145cb445d0ba340b926a4523ccc71c5ee5c72be.png" />
</div>
</div>
<p>La tarjeta más común es la Visa, seguida de la Mastercard. Por otro lado, las tarjetas suelen ser de tipo débito.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">columnas_numericas</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df_fraude</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span> <span class="o">!=</span> <span class="s1">&#39;isFraud&#39;</span><span class="p">]</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">font_scale</span><span class="o">=</span><span class="mf">1.2</span><span class="p">)</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columnas_numericas</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Column: &#39;</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Skew:&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">df_fraude</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">skew</span><span class="p">(),</span> <span class="mi">2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Kurtosis: &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">df_fraude</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">kurtosis</span><span class="p">(),</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">df_fraude</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df_fraude</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  TransactionAmt
Skew: 6.47
Kurtosis:  60.94
</pre></div>
</div>
<img alt="_images/96a20d8a04b6bca2168077378ef5824ca2cbc63230ea296dd7a3eaba5e083c5b.png" src="_images/96a20d8a04b6bca2168077378ef5824ca2cbc63230ea296dd7a3eaba5e083c5b.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  card1
Skew: -0.04
Kurtosis:  -1.12
</pre></div>
</div>
<img alt="_images/189bc83940de8a7629077c7879e80469dcf3d9272de2104a53102c6e3520469e.png" src="_images/189bc83940de8a7629077c7879e80469dcf3d9272de2104a53102c6e3520469e.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  card2
Skew: -0.18
Kurtosis:  -1.32
</pre></div>
</div>
<img alt="_images/19c2041248b6863579a652f06d05944f8c310f27342fec5bc84a1259e17a59e4.png" src="_images/19c2041248b6863579a652f06d05944f8c310f27342fec5bc84a1259e17a59e4.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  C13
Skew: 9.77
Kurtosis:  137.36
</pre></div>
</div>
<img alt="_images/03ff4a6e847655cc3f194c6b540c66ac7a7a72e47fbd880e7e57772e470771b9.png" src="_images/03ff4a6e847655cc3f194c6b540c66ac7a7a72e47fbd880e7e57772e470771b9.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  D1
Skew: 1.81
Kurtosis:  2.24
</pre></div>
</div>
<img alt="_images/e8a34c80f07e38d07c4ce1311654d19072a56b8a5ea6bbee213ffe9a68bd7e3d.png" src="_images/e8a34c80f07e38d07c4ce1311654d19072a56b8a5ea6bbee213ffe9a68bd7e3d.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  D4
Skew: 1.61
Kurtosis:  1.29
</pre></div>
</div>
<img alt="_images/97a78dce1c0f50af1336dc48685d25a07709520d0864a5fea4494238a083399c.png" src="_images/97a78dce1c0f50af1336dc48685d25a07709520d0864a5fea4494238a083399c.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  D10
Skew: 1.56
Kurtosis:  1.15
</pre></div>
</div>
<img alt="_images/8e7a0145a58f4e6890e3acf3d8cbe80864cb487284b9c8a452dfccb223d314d7.png" src="_images/8e7a0145a58f4e6890e3acf3d8cbe80864cb487284b9c8a452dfccb223d314d7.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  V28
Skew: 45.39
Kurtosis:  2311.72
</pre></div>
</div>
<img alt="_images/2f6a9bec6afe3ffba759e337d030f3b7b12a0c56a31a427dcc151046a08efd12.png" src="_images/2f6a9bec6afe3ffba759e337d030f3b7b12a0c56a31a427dcc151046a08efd12.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  V30
Skew: 1.5
Kurtosis:  3.72
</pre></div>
</div>
<img alt="_images/0f62304de444b90fac885d5c56ab8711431bd425ad26c5511623d6ca3e9bb087.png" src="_images/0f62304de444b90fac885d5c56ab8711431bd425ad26c5511623d6ca3e9bb087.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  V40
Skew: 6.87
Kurtosis:  103.72
</pre></div>
</div>
<img alt="_images/8748e03c60a0822a5069bc9ab5572601dca7c134e84b15b4173289ce78cc1352.png" src="_images/8748e03c60a0822a5069bc9ab5572601dca7c134e84b15b4173289ce78cc1352.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  V68
Skew: 56.39
Kurtosis:  3432.7
</pre></div>
</div>
<img alt="_images/58892447caa1e56af293e06bf9d2e8ccf1f1253ea57b4b22159886561e4826df.png" src="_images/58892447caa1e56af293e06bf9d2e8ccf1f1253ea57b4b22159886561e4826df.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  V137
Skew: 28.37
Kurtosis:  1944.01
</pre></div>
</div>
<img alt="_images/09396d4f7c630903d6f0a2dbf79d140edc98119a3740aa10853a5097f227320f.png" src="_images/09396d4f7c630903d6f0a2dbf79d140edc98119a3740aa10853a5097f227320f.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  V281
Skew: 7.94
Kurtosis:  85.9
</pre></div>
</div>
<img alt="_images/9885513b32cb80bf9eb71f4fb8aa2cce6ff7dd8468beca73a02de29ddbe2bdd1.png" src="_images/9885513b32cb80bf9eb71f4fb8aa2cce6ff7dd8468beca73a02de29ddbe2bdd1.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  V283
Skew: 8.74
Kurtosis:  153.01
</pre></div>
</div>
<img alt="_images/07535ef4d7e652e334ec9f7aa08493f028b0de66e1a1eabd5b035aca2f0bc605.png" src="_images/07535ef4d7e652e334ec9f7aa08493f028b0de66e1a1eabd5b035aca2f0bc605.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  V284
Skew: 4.4
Kurtosis:  28.72
</pre></div>
</div>
<img alt="_images/af54abf0b9092e2da1becf0636e77d67f0500b1499fda18a70ae45fee0d9c2db.png" src="_images/af54abf0b9092e2da1becf0636e77d67f0500b1499fda18a70ae45fee0d9c2db.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  V285
Skew: 11.48
Kurtosis:  228.41
</pre></div>
</div>
<img alt="_images/433a704ae28a4de4f1f848f2e51cc9a350eace0f4b1eed2782aa996dc795dff7.png" src="_images/433a704ae28a4de4f1f848f2e51cc9a350eace0f4b1eed2782aa996dc795dff7.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  V286
Skew: 6.42
Kurtosis:  49.49
</pre></div>
</div>
<img alt="_images/586b3a167ee7f63d14f1b2f42306589903789dca37a6239edaf7c00d2c4eadf9.png" src="_images/586b3a167ee7f63d14f1b2f42306589903789dca37a6239edaf7c00d2c4eadf9.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  V290
Skew: 25.61
Kurtosis:  907.26
</pre></div>
</div>
<img alt="_images/a383ed1b9689e1a2b903bf8db18ff058cffe483cd3b159e758cbbea2fd436fee.png" src="_images/a383ed1b9689e1a2b903bf8db18ff058cffe483cd3b159e758cbbea2fd436fee.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  V297
Skew: 13.49
Kurtosis:  216.21
</pre></div>
</div>
<img alt="_images/2cac0f8e83665e2ac85d3f4c7d769f7c349ae30d089ff12684043efb05d777ba.png" src="_images/2cac0f8e83665e2ac85d3f4c7d769f7c349ae30d089ff12684043efb05d777ba.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  V300
Skew: 11.34
Kurtosis:  239.56
</pre></div>
</div>
<img alt="_images/0bede96d77920e2073b160211a8514dc692908dc2d9db6d81fc417b17af027af.png" src="_images/0bede96d77920e2073b160211a8514dc692908dc2d9db6d81fc417b17af027af.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  V303
Skew: 5.57
Kurtosis:  64.08
</pre></div>
</div>
<img alt="_images/135b03d216161644e4121626992022279cc412521914f852b34ed640a450aae7.png" src="_images/135b03d216161644e4121626992022279cc412521914f852b34ed640a450aae7.png" />
</div>
</div>
<ul class="simple">
<li><p>Transacción amount presenta bastantes valores atípicos, y la mayoría de los valores de la transacción son pequeños comparados con estos.</p></li>
<li><p>Las variables D de manera general presentan comportamientos similares de dispersión y se encuentran sesgados a la derecha.</p></li>
<li><p>Las variables V a excepción de la V20 y V28 toman valores de 0 o cercanos en su mayoría, y cuentan con una al ta presencia de atípicos.</p></li>
<li><p>La card1 y card 2 no tienen datos atípicos, la card1 presenta una distribución un poco constante de sus valores.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">columnas</span> <span class="o">=</span> <span class="n">df_fraude</span><span class="o">.</span><span class="n">columns</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columnas</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;isFraud&#39;</span><span class="p">,</span> <span class="s2">&quot;TransactionAmt&quot;</span><span class="p">]:</span>  
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_fraude</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;TransactionAmt&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;isFraud&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Scatterplot de </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1"> vs TransactionAmt&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;TransactionAmt&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;isFraud&#39;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/588705a36ee7ccd87473fd5846cb50dc49bb42ba265a27d65a456fd1b6908dad.png" src="_images/588705a36ee7ccd87473fd5846cb50dc49bb42ba265a27d65a456fd1b6908dad.png" />
<img alt="_images/9db6dd886226b4f4dd8d384e7e1a4f1f17ca41c1fd821d55d2544cbf30a2e80a.png" src="_images/9db6dd886226b4f4dd8d384e7e1a4f1f17ca41c1fd821d55d2544cbf30a2e80a.png" />
<img alt="_images/e6b7f61104fc81dd8d17a531a5549fab131493be3764f1a75a8decc03b861c60.png" src="_images/e6b7f61104fc81dd8d17a531a5549fab131493be3764f1a75a8decc03b861c60.png" />
<img alt="_images/76f7f78749a75041029007d17d4374a66035d2c9c607c7001a076951bbab32ed.png" src="_images/76f7f78749a75041029007d17d4374a66035d2c9c607c7001a076951bbab32ed.png" />
<img alt="_images/97fdd15c72730097df96a50d3562be3bc791199b162f4b10d680511d783e9916.png" src="_images/97fdd15c72730097df96a50d3562be3bc791199b162f4b10d680511d783e9916.png" />
<img alt="_images/da355130f4df725d49e5fccbce556f4a2de075fa74a2e99bed7fbf06d5c1414a.png" src="_images/da355130f4df725d49e5fccbce556f4a2de075fa74a2e99bed7fbf06d5c1414a.png" />
<img alt="_images/92d56cb5d062eed803c9e2d7a5bcc02925882cc2d7bf1fabe960af0098a58928.png" src="_images/92d56cb5d062eed803c9e2d7a5bcc02925882cc2d7bf1fabe960af0098a58928.png" />
<img alt="_images/fcabb4bee0b3f0f6a94b378177e489a2f658a7b25edaef702117cea645ec3f17.png" src="_images/fcabb4bee0b3f0f6a94b378177e489a2f658a7b25edaef702117cea645ec3f17.png" />
<img alt="_images/d85776b14b991e006d16d1141d128dc7e9166755816d77a810712be9ffc00d14.png" src="_images/d85776b14b991e006d16d1141d128dc7e9166755816d77a810712be9ffc00d14.png" />
<img alt="_images/db1c1f6e6adc09d48f56b7c1882875fc930a8978aa541a94779834781a61df58.png" src="_images/db1c1f6e6adc09d48f56b7c1882875fc930a8978aa541a94779834781a61df58.png" />
<img alt="_images/2b2cf0a2eb4a30bcfd122a51336066c696c1ac5026159ebc3d9fcad721cac990.png" src="_images/2b2cf0a2eb4a30bcfd122a51336066c696c1ac5026159ebc3d9fcad721cac990.png" />
<img alt="_images/eb50b3dc0464f2f45207b61e91f5b1e9102386d4d7bee8bd4a461f8e1d8eb78d.png" src="_images/eb50b3dc0464f2f45207b61e91f5b1e9102386d4d7bee8bd4a461f8e1d8eb78d.png" />
<img alt="_images/a036b78be64f18aa5cf08ead54103a7f3774edc5008a9125385e9639dba6bcce.png" src="_images/a036b78be64f18aa5cf08ead54103a7f3774edc5008a9125385e9639dba6bcce.png" />
<img alt="_images/5c66bfc4e7a97d1c1d95aa26f5cf0b5eedb364ba5421f87a710cfb8bce4ed961.png" src="_images/5c66bfc4e7a97d1c1d95aa26f5cf0b5eedb364ba5421f87a710cfb8bce4ed961.png" />
<img alt="_images/245e4ec7babcb3f4aee963b7719ab8275cd9d63bc67a3177072d7ae3314244d5.png" src="_images/245e4ec7babcb3f4aee963b7719ab8275cd9d63bc67a3177072d7ae3314244d5.png" />
<img alt="_images/b6af8537f7e0b00bbd35fdea2251c0e524cb156f886e95a76c0ca3a3cd0a95e4.png" src="_images/b6af8537f7e0b00bbd35fdea2251c0e524cb156f886e95a76c0ca3a3cd0a95e4.png" />
<img alt="_images/e11ca3c0a9bde1120b4fc58c9562c18662cb0d5f266c1794e8671c1d797fcb99.png" src="_images/e11ca3c0a9bde1120b4fc58c9562c18662cb0d5f266c1794e8671c1d797fcb99.png" />
<img alt="_images/7358596abd9c6b1a858caef96fd5cfdcb58b5e9049033e60db3146ffeaab749c.png" src="_images/7358596abd9c6b1a858caef96fd5cfdcb58b5e9049033e60db3146ffeaab749c.png" />
<img alt="_images/0a7da439fde617047aa2561609f794275a8d94c1a99159bf11dcc5ede9fd4e61.png" src="_images/0a7da439fde617047aa2561609f794275a8d94c1a99159bf11dcc5ede9fd4e61.png" />
<img alt="_images/d1d697cba632b83bed09baf22dc5c01039a5336f0779b3563a523ab016bc7430.png" src="_images/d1d697cba632b83bed09baf22dc5c01039a5336f0779b3563a523ab016bc7430.png" />
<img alt="_images/e0ac10f9828816a15378bb63b86c9e6f0d914fdf2d145872a3defae9cfffd50e.png" src="_images/e0ac10f9828816a15378bb63b86c9e6f0d914fdf2d145872a3defae9cfffd50e.png" />
<img alt="_images/3671886177dac9d24e27af70228eefc11910040a6db60d933a2462777f5f0cc2.png" src="_images/3671886177dac9d24e27af70228eefc11910040a6db60d933a2462777f5f0cc2.png" />
<img alt="_images/2571fee9705ab6498c7eb599cd6ffbbbfedd625573bca999e8daed2522e7b075.png" src="_images/2571fee9705ab6498c7eb599cd6ffbbbfedd625573bca999e8daed2522e7b075.png" />
<img alt="_images/5ecb34fd55f0b90fd2ebf38b18fe072539dde22056695dff3d308ddfa15d0c56.png" src="_images/5ecb34fd55f0b90fd2ebf38b18fe072539dde22056695dff3d308ddfa15d0c56.png" />
<img alt="_images/4848e4b55f32e91bee4b0364b118a95e900a4e6f37b9e3589a98320d63a0c41f.png" src="_images/4848e4b55f32e91bee4b0364b118a95e900a4e6f37b9e3589a98320d63a0c41f.png" />
<img alt="_images/23bfc834203335293302ec2067f18bd9faa44c32e3394b7fdab598368aa66933.png" src="_images/23bfc834203335293302ec2067f18bd9faa44c32e3394b7fdab598368aa66933.png" />
<img alt="_images/dc4bd4d9e499c4ff6144a86384aa6bac0719f3b0cb539477d851c21686196e69.png" src="_images/dc4bd4d9e499c4ff6144a86384aa6bac0719f3b0cb539477d851c21686196e69.png" />
<img alt="_images/d6e916f569cddaa68d639395f756da2c0945b0759773f3a3263902a7e37a5900.png" src="_images/d6e916f569cddaa68d639395f756da2c0945b0759773f3a3263902a7e37a5900.png" />
</div>
</div>
<ul class="simple">
<li><p>Para valores grandes de V311 y de TransactionAmount la presencia de transacciones limpias es más notoria.</p></li>
<li><p>Todas las transacciones de alto valor tienen V303 cero.</p></li>
<li><p>A medida que V297 aumenta el valor de la transacción disminuye.</p></li>
<li><p>Las transacciones de fraude se ubican en valores de V285 bajos, sin importar la cantidad de la transacción.</p></li>
<li><p>No se evidencia una diferencia clara entre el fraude y las variables D y card.</p></li>
</ul>
</section>
</section>
<section id="modelado">
<h1>Modelado<a class="headerlink" href="#modelado" title="Permalink to this heading">#</a></h1>
<p>Se realizarán distintos modelos basados para la selección del modelo con mejor comportamiento en la métrica AUC.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">make_pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">precision_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">recall_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">f1_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">roc_auc_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">roc_curve</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">BernoulliNB</span>
<span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="kn">import</span> <span class="n">MLPClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
<span class="kn">import</span> <span class="nn">xgboost</span> <span class="k">as</span> <span class="nn">xgb</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">precision_recall_curve</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_fraude</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;isFraud&#39;, &#39;TransactionAmt&#39;, &#39;card1&#39;, &#39;card2&#39;, &#39;C13&#39;, &#39;D1&#39;, &#39;D4&#39;, &#39;D10&#39;,
       &#39;V28&#39;, &#39;V30&#39;, &#39;V40&#39;, &#39;V68&#39;, &#39;V137&#39;, &#39;V281&#39;, &#39;V283&#39;, &#39;V284&#39;, &#39;V285&#39;,
       &#39;V286&#39;, &#39;V290&#39;, &#39;V297&#39;, &#39;V300&#39;, &#39;V303&#39;, &#39;V311&#39;, &#39;V314&#39;,
       &#39;card4_discover&#39;, &#39;card4_mastercard&#39;, &#39;card4_visa&#39;, &#39;card6_credit&#39;,
       &#39;card6_debit&#39;, &#39;card6_debit or credit&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Se realiza la sepación de las variables y del conjunto de entrenamiento y testing</span>
<span class="n">fraude_x</span> <span class="o">=</span> <span class="n">df_fraude</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;isFraud&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fraude_y</span> <span class="o">=</span> <span class="n">df_fraude</span><span class="p">[</span><span class="s1">&#39;isFraud&#39;</span><span class="p">]</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">fraude_x</span><span class="p">,</span> <span class="n">fraude_y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(69606, 29)
(69606,)
(23202, 29)
(23202,)
</pre></div>
</div>
</div>
</div>
<section id="knn-neighbors">
<h2>Knn Neighbors<a class="headerlink" href="#knn-neighbors" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipeline_knn</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">MinMaxScaler</span><span class="p">(</span><span class="n">feature_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">KNeighborsClassifier</span><span class="p">())</span>
<span class="n">grid_parametros</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;kneighborsclassifier__n_neighbors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]}</span>

<span class="n">grid_knn</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipeline_knn</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">grid_parametros</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">)</span>
<span class="n">grid_knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grid_knn</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>

<span class="n">predicciones_knn</span> <span class="o">=</span> <span class="n">grid_knn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1">#Metricas</span>
<span class="n">auc</span> <span class="o">=</span><span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predicciones_knn</span><span class="p">)</span>
<span class="n">recall</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predicciones_knn</span><span class="p">)</span>
<span class="n">precision</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predicciones_knn</span><span class="p">)</span>
<span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predicciones_knn</span><span class="p">)</span>

<span class="n">metricas_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Modelo&quot;</span><span class="p">,</span><span class="s1">&#39;AUC&#39;</span><span class="p">,</span> <span class="s1">&#39;Recall&#39;</span><span class="p">,</span> <span class="s1">&#39;Precision&#39;</span><span class="p">,</span> <span class="s1">&#39;F1&#39;</span><span class="p">])</span>
<span class="n">KNN</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Modelo&quot;</span><span class="p">:</span> <span class="s2">&quot;Knn&quot;</span><span class="p">,</span> <span class="s1">&#39;AUC&#39;</span><span class="p">:</span> <span class="n">auc</span><span class="p">,</span> <span class="s1">&#39;Recall&#39;</span><span class="p">:</span> <span class="n">recall</span><span class="p">,</span> <span class="s1">&#39;Precision&#39;</span><span class="p">:</span> <span class="n">precision</span><span class="p">,</span> <span class="s1">&#39;F1&#39;</span><span class="p">:</span> <span class="n">f1</span><span class="p">}</span>

<span class="n">confusion_KNN</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predicciones_knn</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Confusion matrix:</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">confusion_KNN</span><span class="p">))</span>

<span class="c1"># Calcular la curva ROC utilizando las probabilidades de clase</span>
<span class="n">probs_knn</span> <span class="o">=</span> <span class="n">grid_knn</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">thresholds</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">probs_knn</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>

<span class="c1"># Graficar la curva ROC</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;ROC Curve&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;FPR&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;TPR (recall)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Random&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;kneighborsclassifier__n_neighbors&#39;: 10}
Confusion matrix:
[[18216   687]
 [ 2228  2071]]
</pre></div>
</div>
<img alt="_images/60eb2b782707521bb01f3199891ec4f9ddc65813c24425af00ada42aa2195d6b.png" src="_images/60eb2b782707521bb01f3199891ec4f9ddc65813c24425af00ada42aa2195d6b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">knn_params</span> <span class="o">=</span> <span class="n">grid_knn</span><span class="o">.</span><span class="n">best_params_</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metricas_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">metricas_df</span><span class="p">)]</span> <span class="o">=</span> <span class="n">KNN</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="naive-bayes">
<h2>Naive Bayes<a class="headerlink" href="#naive-bayes" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipeline_NB</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">MinMaxScaler</span><span class="p">(</span><span class="n">feature_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">BernoulliNB</span><span class="p">())</span>
<span class="n">grid_parametros</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;bernoullinb__alpha&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]}</span>

<span class="n">grid_NB</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipeline_NB</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">grid_parametros</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">)</span>
<span class="n">grid_NB</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grid_NB</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>

<span class="n">predicciones_NB</span> <span class="o">=</span> <span class="n">grid_NB</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1">#Metricas</span>
<span class="n">auc</span> <span class="o">=</span><span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predicciones_NB</span><span class="p">)</span>
<span class="n">recall</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predicciones_NB</span><span class="p">)</span>
<span class="n">precision</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predicciones_NB</span><span class="p">)</span>
<span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predicciones_NB</span><span class="p">)</span>

<span class="n">NaiveBayes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Modelo&quot;</span><span class="p">:</span> <span class="s2">&quot;NaiveBayes&quot;</span><span class="p">,</span> <span class="s1">&#39;AUC&#39;</span><span class="p">:</span> <span class="n">auc</span><span class="p">,</span> <span class="s1">&#39;Recall&#39;</span><span class="p">:</span> <span class="n">recall</span><span class="p">,</span> <span class="s1">&#39;Precision&#39;</span><span class="p">:</span> <span class="n">precision</span><span class="p">,</span> <span class="s1">&#39;F1&#39;</span><span class="p">:</span> <span class="n">f1</span><span class="p">}</span>

<span class="n">confusion_NB</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predicciones_NB</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Confusion matrix:</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">confusion_NB</span><span class="p">))</span>

<span class="c1"># Calcular la curva ROC utilizando las probabilidades de clase</span>
<span class="n">probs_NB</span> <span class="o">=</span> <span class="n">grid_NB</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">thresholds</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">probs_NB</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>

<span class="c1"># Graficar la curva ROC</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;ROC Curve&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;FPR&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;TPR (recall)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Random&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;bernoullinb__alpha&#39;: 0}
Confusion matrix:
[[15871  3032]
 [ 1915  2384]]
</pre></div>
</div>
<img alt="_images/80e4d4a92a5b447b80361818a14971e903d0acb6bab979f1ef2161e0cf66a167.png" src="_images/80e4d4a92a5b447b80361818a14971e903d0acb6bab979f1ef2161e0cf66a167.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">NaiveBayes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Modelo&#39;: &#39;NaiveBayes&#39;,
 &#39;AUC&#39;: 0.6970748743751799,
 &#39;Recall&#39;: 0.55454756920214,
 &#39;Precision&#39;: 0.4401772525849335,
 &#39;F1&#39;: 0.4907874420998456}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metricas_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">metricas_df</span><span class="p">)]</span> <span class="o">=</span> <span class="n">NaiveBayes</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="xgboost">
<h2>XGBoost<a class="headerlink" href="#xgboost" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipeline_XGB</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">MinMaxScaler</span><span class="p">(</span><span class="n">feature_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">xgb</span><span class="o">.</span><span class="n">XGBClassifier</span><span class="p">())</span>
<span class="n">grid_parametros</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;xgbclassifier__learning_rate&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;xgbclassifier__max_depth&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="s2">&quot;xgbclassifier__n_estimators&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">40</span><span class="p">]}</span>

<span class="n">grid_XGB</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipeline_XGB</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">grid_parametros</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">)</span>
<span class="n">grid_XGB</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grid_XGB</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>

<span class="n">predicciones_XGB</span> <span class="o">=</span> <span class="n">grid_XGB</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1">#Metricas</span>
<span class="n">auc</span> <span class="o">=</span><span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predicciones_XGB</span><span class="p">)</span>
<span class="n">recall</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predicciones_XGB</span><span class="p">)</span>
<span class="n">precision</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predicciones_XGB</span><span class="p">)</span>
<span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predicciones_XGB</span><span class="p">)</span>

<span class="n">XGB</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Modelo&quot;</span><span class="p">:</span> <span class="s2">&quot;XGB&quot;</span><span class="p">,</span> <span class="s1">&#39;AUC&#39;</span><span class="p">:</span> <span class="n">auc</span><span class="p">,</span> <span class="s1">&#39;Recall&#39;</span><span class="p">:</span> <span class="n">recall</span><span class="p">,</span> <span class="s1">&#39;Precision&#39;</span><span class="p">:</span> <span class="n">precision</span><span class="p">,</span> <span class="s1">&#39;F1&#39;</span><span class="p">:</span> <span class="n">f1</span><span class="p">}</span>

<span class="n">confusion_XGB</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predicciones_XGB</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Confusion matrix:</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">confusion_XGB</span><span class="p">))</span>

<span class="c1"># Calcular la curva ROC utilizando las probabilidades de clase</span>
<span class="n">probs_XGB</span> <span class="o">=</span> <span class="n">grid_XGB</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">thresholds</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">probs_XGB</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>

<span class="c1"># Graficar la curva ROC</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;ROC Curve&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;FPR&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;TPR (recall)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Random&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;xgbclassifier__learning_rate&#39;: 1, &#39;xgbclassifier__max_depth&#39;: 5, &#39;xgbclassifier__n_estimators&#39;: 40}
Confusion matrix:
[[18106   797]
 [ 1907  2392]]
</pre></div>
</div>
<img alt="_images/f38768b5f95d7ae9dc13d19c41f373c1abd7ed02399431e17cb4061b2295b73c.png" src="_images/f38768b5f95d7ae9dc13d19c41f373c1abd7ed02399431e17cb4061b2295b73c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid_XGB</span><span class="o">.</span><span class="n">best_params_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;xgbclassifier__learning_rate&#39;: 1,
 &#39;xgbclassifier__max_depth&#39;: 5,
 &#39;xgbclassifier__n_estimators&#39;: 40}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metricas_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">metricas_df</span><span class="p">)]</span> <span class="o">=</span> <span class="n">XGB</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="svm">
<h2>SVM<a class="headerlink" href="#svm" title="Permalink to this heading">#</a></h2>
<p>Con el tamaño inicial, no alcanzó a terminar. Se procede a disminuir el tamaño.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipeline_SVC</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">MinMaxScaler</span><span class="p">(</span><span class="n">feature_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">SVC</span><span class="p">(</span><span class="n">probability</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="n">grid_parametros</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;svc__C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;svc__gamma&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;svc__kernel&quot;</span><span class="p">:</span>  <span class="p">[</span><span class="s2">&quot;rbf&quot;</span><span class="p">]}</span>

<span class="n">grid_SVC</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipeline_SVC</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">grid_parametros</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">)</span>
<span class="n">grid_SVC</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">[:</span><span class="mi">5000</span><span class="p">],</span> <span class="n">y_train</span><span class="p">[:</span><span class="mi">5000</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grid_SVC</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>

<span class="n">predicciones_SVC</span> <span class="o">=</span> <span class="n">grid_SVC</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Metricas</span>
<span class="n">auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predicciones_SVC</span><span class="p">)</span>
<span class="n">recall</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predicciones_SVC</span><span class="p">)</span>
<span class="n">precision</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predicciones_SVC</span><span class="p">)</span>
<span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predicciones_SVC</span><span class="p">)</span>

<span class="c1"># Guardar los resultados en un diccionario</span>
<span class="n">SVC_</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Modelo&quot;</span><span class="p">:</span> <span class="s2">&quot;SVC&quot;</span><span class="p">,</span> <span class="s1">&#39;AUC&#39;</span><span class="p">:</span> <span class="n">auc</span><span class="p">,</span> <span class="s1">&#39;Recall&#39;</span><span class="p">:</span> <span class="n">recall</span><span class="p">,</span> <span class="s1">&#39;Precision&#39;</span><span class="p">:</span> <span class="n">precision</span><span class="p">,</span> <span class="s1">&#39;F1&#39;</span><span class="p">:</span> <span class="n">f1</span><span class="p">}</span>

<span class="n">confusion_SVC</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predicciones_SVC</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Confusion matrix:</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">confusion_SVC</span><span class="p">))</span>

<span class="c1"># Calcular la curva ROC utilizando las probabilidades de clase</span>
<span class="n">probs_SVC</span> <span class="o">=</span> <span class="n">grid_SVC</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">thresholds</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">probs_SVC</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>

<span class="c1"># Graficar la curva ROC</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;ROC Curve&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;FPR&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;TPR (recall)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Random&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;svc__C&#39;: 1, &#39;svc__gamma&#39;: 1, &#39;svc__kernel&#39;: &#39;rbf&#39;}
Confusion matrix:
[[18796   107]
 [ 4002   297]]
</pre></div>
</div>
<img alt="_images/0ff6f6e5e1982f5d0b595a6e276a2e92bfaaed0bcb558744b3bc953652b10b89.png" src="_images/0ff6f6e5e1982f5d0b595a6e276a2e92bfaaed0bcb558744b3bc953652b10b89.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid_SVC</span><span class="o">.</span><span class="n">best_params_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;svc__C&#39;: 1, &#39;svc__gamma&#39;: 1, &#39;svc__kernel&#39;: &#39;rbf&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metricas_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">metricas_df</span><span class="p">)]</span> <span class="o">=</span> <span class="n">SVC</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="mlp">
<h2>MLP<a class="headerlink" href="#mlp" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipeline_MLP</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">MinMaxScaler</span><span class="p">(</span><span class="n">feature_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">MLPClassifier</span><span class="p">(</span><span class="n">solver</span> <span class="o">=</span> <span class="s2">&quot;lbfgs&quot;</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">400</span><span class="p">))</span>
<span class="n">grid_parametros</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;mlpclassifier__activation&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span> <span class="s2">&quot;tanh&quot;</span><span class="p">,</span> <span class="s2">&quot;sigmoid&quot;</span><span class="p">],</span> <span class="s2">&quot;mlpclassifier__alpha&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
                   <span class="s2">&quot;mlpclassifier__hidden_layer_sizes&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">50</span><span class="p">]</span> <span class="p">}</span>
<span class="n">grid_MLP</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipeline_MLP</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">grid_parametros</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">)</span>
<span class="n">grid_MLP</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">[:</span><span class="mi">10000</span><span class="p">],</span> <span class="n">y_train</span><span class="p">[:</span><span class="mi">10000</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grid_MLP</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>

<span class="n">predicciones_MLP</span> <span class="o">=</span> <span class="n">grid_MLP</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1">#Metricas</span>
<span class="n">auc</span> <span class="o">=</span><span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predicciones_MLP</span><span class="p">)</span>
<span class="n">recall</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predicciones_MLP</span><span class="p">)</span>
<span class="n">precision</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predicciones_MLP</span><span class="p">)</span>
<span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predicciones_MLP</span><span class="p">)</span>

<span class="n">MLP</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Modelo&quot;</span><span class="p">:</span> <span class="s2">&quot;MLP&quot;</span><span class="p">,</span> <span class="s1">&#39;AUC&#39;</span><span class="p">:</span> <span class="n">auc</span><span class="p">,</span> <span class="s1">&#39;Recall&#39;</span><span class="p">:</span> <span class="n">recall</span><span class="p">,</span> <span class="s1">&#39;Precision&#39;</span><span class="p">:</span> <span class="n">precision</span><span class="p">,</span> <span class="s1">&#39;F1&#39;</span><span class="p">:</span> <span class="n">f1</span><span class="p">}</span>

<span class="n">confusion_MLP</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predicciones_MLP</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Confusion matrix:</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">confusion_MLP</span><span class="p">))</span>

<span class="c1"># Calcular la curva ROC utilizando las probabilidades de clase</span>
<span class="n">probs_MLP</span> <span class="o">=</span> <span class="n">grid_MLP</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">thresholds</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">probs_MLP</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>

<span class="c1"># Graficar la curva ROC</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;ROC Curve&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;FPR&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;TPR (recall)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Random&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;mlpclassifier__activation&#39;: &#39;tanh&#39;, &#39;mlpclassifier__alpha&#39;: 0.1, &#39;mlpclassifier__hidden_layer_sizes&#39;: 10}
Confusion matrix:
[[17814  1089]
 [ 2578  1721]]
</pre></div>
</div>
<img alt="_images/f254963bb7a938ef3cd614f0aec888beb19b24bfe36115df8847e31f426032bb.png" src="_images/f254963bb7a938ef3cd614f0aec888beb19b24bfe36115df8847e31f426032bb.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid_MLP</span><span class="o">.</span><span class="n">best_params_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;mlpclassifier__activation&#39;: &#39;tanh&#39;,
 &#39;mlpclassifier__alpha&#39;: 0.1,
 &#39;mlpclassifier__hidden_layer_sizes&#39;: 10}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metricas_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">metricas_df</span><span class="p">)]</span> <span class="o">=</span> <span class="n">MLP</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metricas_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>AUC</th>
      <th>Recall</th>
      <th>Precision</th>
      <th>F1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Knn</td>
      <td>0.722698</td>
      <td>0.481740</td>
      <td>0.750906</td>
      <td>0.586935</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaiveBayes</td>
      <td>0.697075</td>
      <td>0.554548</td>
      <td>0.440177</td>
      <td>0.490787</td>
    </tr>
    <tr>
      <th>2</th>
      <td>XGB</td>
      <td>0.757123</td>
      <td>0.556408</td>
      <td>0.750078</td>
      <td>0.638889</td>
    </tr>
    <tr>
      <th>3</th>
      <td>SVC</td>
      <td>0.531713</td>
      <td>0.069086</td>
      <td>0.735149</td>
      <td>0.126302</td>
    </tr>
    <tr>
      <th>4</th>
      <td>MLP</td>
      <td>0.671358</td>
      <td>0.400326</td>
      <td>0.612456</td>
      <td>0.484175</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>XGB tiene el AUC más alto entre todos los modelos, esto se aprecia en la curva ROC puesto que es el modelo con la línea más cerca a la esquina superior izquierda. Este a su vez tiene el mejor recall, el mejor F1 y la segunda mejor precision.</p></li>
<li><p>El segundo mejor modelo en términos de AUC es Knn con 10 vecinos, y presenta un rendimiento competitivo con XGBoost.</p></li>
</ul>
<p>El mejor modelo basado en la optimización del AUC es: <strong>XGB</strong> con parámetros learning_rate: 1, max_depth: 5, n_estimators: 40. El AUC en el conjunto de testing es 0.75.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Welcome to your Jupyter Book</p>
      </div>
    </a>
    <a class="right-next"
       href="WindSpeed.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">WIND SPEED</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">FRAUD DETECTION</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eda">EDA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vif">VIF</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizacion">Visualización</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modelado">Modelado</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#knn-neighbors">Knn Neighbors</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#naive-bayes">Naive Bayes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#xgboost">XGBoost</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#svm">SVM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mlp">MLP</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>