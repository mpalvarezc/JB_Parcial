

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>WIND SPEED &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'WindSpeed';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="FRAUD DETECTION" href="FraudDetection.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="FraudDetection.html">FRAUD DETECTION</a></li>

<li class="toctree-l1 current active"><a class="current reference internal" href="#">WIND SPEED</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FWindSpeed.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/WindSpeed.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>WIND SPEED</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eda">EDA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelado"><strong>MODELADO</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusiones">Conclusiones</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="wind-speed">
<h1>WIND SPEED<a class="headerlink" href="#wind-speed" title="Permalink to this heading">#</a></h1>
<p>A continuación se presenta el ánalisis y modelado resultante de una recopilación de datos de mediciondes de la velocidad del viento. El tema propuesto tiene amplias implicaciones en varias áreas, el análisis se enfoca en el impacto para la producción de energía eólica, la cual al ser une energía limpia contribuye a la sostenibilidad ambiental.</p>
<section id="eda">
<h2>EDA<a class="headerlink" href="#eda" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">linear_model</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">import</span> <span class="nn">xgboost</span> <span class="k">as</span> <span class="nn">xgb</span>
<span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="kn">import</span> <span class="n">MLPRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
<span class="kn">import</span> <span class="nn">warnings</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wind_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;C:\MariaP\MachineLearning\Parcial\Data\wind\data_treino_dv_df_2000_2010.csv&quot;</span>
<span class="n">wind</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">wind_path</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span> <span class="s2">&quot;UTF-8&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wind</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>HORA (UTC)</th>
      <th>VENTO, DIREï¿½ï¿½O HORARIA (gr) (ï¿½ (gr))</th>
      <th>VENTO, VELOCIDADE HORARIA (m/s)</th>
      <th>UMIDADE REL. MAX. NA HORA ANT. (AUT) (%)</th>
      <th>UMIDADE REL. MIN. NA HORA ANT. (AUT) (%)</th>
      <th>TEMPERATURA Mï¿½XIMA NA HORA ANT. (AUT) (ï¿½C)</th>
      <th>TEMPERATURA Mï¿½NIMA NA HORA ANT. (AUT) (ï¿½C)</th>
      <th>UMIDADE RELATIVA DO AR, HORARIA (%)</th>
      <th>PRESSAO ATMOSFERICA AO NIVEL DA ESTACAO, HORARIA (mB)</th>
      <th>PRECIPITAï¿½ï¿½O TOTAL, HORï¿½RIO (mm)</th>
      <th>VENTO, RAJADA MAXIMA (m/s)</th>
      <th>PRESSï¿½O ATMOSFERICA MAX.NA HORA ANT. (AUT) (mB)</th>
      <th>PRESSï¿½O ATMOSFERICA MIN. NA HORA ANT. (AUT) (mB)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12:00</td>
      <td>0.809017</td>
      <td>1.8</td>
      <td>69.0</td>
      <td>60.0</td>
      <td>22.6</td>
      <td>20.7</td>
      <td>61.0</td>
      <td>888.2</td>
      <td>0.0</td>
      <td>3.8</td>
      <td>888.2</td>
      <td>887.7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13:00</td>
      <td>0.965926</td>
      <td>2.7</td>
      <td>62.0</td>
      <td>55.0</td>
      <td>24.2</td>
      <td>22.5</td>
      <td>55.0</td>
      <td>888.4</td>
      <td>0.0</td>
      <td>4.7</td>
      <td>888.4</td>
      <td>888.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>14:00</td>
      <td>0.891007</td>
      <td>2.0</td>
      <td>56.0</td>
      <td>50.0</td>
      <td>25.5</td>
      <td>24.3</td>
      <td>51.0</td>
      <td>888.1</td>
      <td>0.0</td>
      <td>4.9</td>
      <td>888.4</td>
      <td>888.1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15:00</td>
      <td>0.848048</td>
      <td>2.5</td>
      <td>52.0</td>
      <td>44.0</td>
      <td>27.4</td>
      <td>25.0</td>
      <td>44.0</td>
      <td>887.4</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>888.1</td>
      <td>887.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>16:00</td>
      <td>0.224951</td>
      <td>2.4</td>
      <td>50.0</td>
      <td>43.0</td>
      <td>27.1</td>
      <td>25.5</td>
      <td>46.0</td>
      <td>886.5</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>887.4</td>
      <td>886.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Como se puede observar las columnas tienen carácteres especiales/extraños, se procederá a cambiar los títulos de las columnas para un mejor entendimiento</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nombres_originales</span> <span class="o">=</span> <span class="n">wind</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">nuevos_nombres</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">,</span> <span class="s1">&#39;Dirección del viento horaria&#39;</span><span class="p">,</span> <span class="s1">&#39;Velocidad horario del viento (m/s)&#39;</span><span class="p">,</span> <span class="s2">&quot;Humedad rel. máx. hora anterior (AUT) ( %)&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;Humedad rel. mín. hora anterior (AUT) ( %)&quot;</span><span class="p">,</span> <span class="s2">&quot;Temperatura máx. hora anterior (AUT)(℃)&quot;</span><span class="p">,</span> 
                  <span class="s2">&quot;Temperatura mín. hora anterior (AUT)( ℃)&quot;</span><span class="p">,</span> <span class="s2">&quot;Humedad relativa horaria ( %)&quot;</span><span class="p">,</span> 
                  <span class="s2">&quot;Presión atmosférica a nivel de estación, horaria (mB)&quot;</span><span class="p">,</span> <span class="s2">&quot;Precipitación total por hora (mm)&quot;</span><span class="p">,</span> 
                  <span class="s2">&quot;Máxima ráfaga de viento (m/s)&quot;</span><span class="p">,</span> <span class="s2">&quot;Presión atmosférica máx. hora anterior (AUT) (mB)&quot;</span><span class="p">,</span> 
                  <span class="s2">&quot;Presión atmosférica mín. hora anterior (AUT) (mB)&quot;</span><span class="p">]</span>

<span class="n">nuevos_nombres_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">nombres_originales</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span> <span class="n">nuevos_nombres</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nombres_originales</span><span class="p">))}</span>
<span class="n">wind</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">nuevos_nombres_dict</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">wind</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Hora</th>
      <th>Dirección del viento horaria</th>
      <th>Velocidad horario del viento (m/s)</th>
      <th>Humedad rel. máx. hora anterior (AUT) ( %)</th>
      <th>Humedad rel. mín. hora anterior (AUT) ( %)</th>
      <th>Temperatura máx. hora anterior (AUT)(℃)</th>
      <th>Temperatura mín. hora anterior (AUT)( ℃)</th>
      <th>Humedad relativa horaria ( %)</th>
      <th>Presión atmosférica a nivel de estación, horaria (mB)</th>
      <th>Precipitación total por hora (mm)</th>
      <th>Máxima ráfaga de viento (m/s)</th>
      <th>Presión atmosférica máx. hora anterior (AUT) (mB)</th>
      <th>Presión atmosférica mín. hora anterior (AUT) (mB)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12:00</td>
      <td>0.809017</td>
      <td>1.8</td>
      <td>69.0</td>
      <td>60.0</td>
      <td>22.6</td>
      <td>20.7</td>
      <td>61.0</td>
      <td>888.2</td>
      <td>0.0</td>
      <td>3.8</td>
      <td>888.2</td>
      <td>887.7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13:00</td>
      <td>0.965926</td>
      <td>2.7</td>
      <td>62.0</td>
      <td>55.0</td>
      <td>24.2</td>
      <td>22.5</td>
      <td>55.0</td>
      <td>888.4</td>
      <td>0.0</td>
      <td>4.7</td>
      <td>888.4</td>
      <td>888.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>14:00</td>
      <td>0.891007</td>
      <td>2.0</td>
      <td>56.0</td>
      <td>50.0</td>
      <td>25.5</td>
      <td>24.3</td>
      <td>51.0</td>
      <td>888.1</td>
      <td>0.0</td>
      <td>4.9</td>
      <td>888.4</td>
      <td>888.1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15:00</td>
      <td>0.848048</td>
      <td>2.5</td>
      <td>52.0</td>
      <td>44.0</td>
      <td>27.4</td>
      <td>25.0</td>
      <td>44.0</td>
      <td>887.4</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>888.1</td>
      <td>887.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>16:00</td>
      <td>0.224951</td>
      <td>2.4</td>
      <td>50.0</td>
      <td>43.0</td>
      <td>27.1</td>
      <td>25.5</td>
      <td>46.0</td>
      <td>886.5</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>887.4</td>
      <td>886.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Por lo que se aprecia al mostrar las primeras columnas, es que todos los daton son númericos. Vamos a verificarlo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wind</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 87693 entries, 0 to 87692
Data columns (total 13 columns):
 #   Column                                                 Non-Null Count  Dtype  
---  ------                                                 --------------  -----  
 0   Hora                                                   87693 non-null  object 
 1   Dirección del viento horaria                           87693 non-null  float64
 2   Velocidad horario del viento (m/s)                     87693 non-null  float64
 3   Humedad rel. máx. hora anterior (AUT) ( %)             87693 non-null  float64
 4   Humedad rel. mín. hora anterior (AUT) ( %)             87693 non-null  float64
 5   Temperatura máx. hora anterior (AUT)(℃)                87693 non-null  float64
 6   Temperatura mín. hora anterior (AUT)( ℃)               87693 non-null  float64
 7   Humedad relativa horaria ( %)                          87693 non-null  float64
 8   Presión atmosférica a nivel de estación, horaria (mB)  87693 non-null  float64
 9   Precipitación total por hora (mm)                      87693 non-null  float64
 10  Máxima ráfaga de viento (m/s)                          87693 non-null  float64
 11  Presión atmosférica máx. hora anterior (AUT) (mB)      87693 non-null  float64
 12  Presión atmosférica mín. hora anterior (AUT) (mB)      87693 non-null  float64
dtypes: float64(12), object(1)
memory usage: 8.7+ MB
</pre></div>
</div>
</div>
</div>
<p>La variable hora es de tipo objeto, se convertirá a númerico para facilitar su procesamiento.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wind</span><span class="o">.</span><span class="n">Hora</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;12:00&#39;, &#39;13:00&#39;, &#39;14:00&#39;, &#39;15:00&#39;, &#39;16:00&#39;, &#39;17:00&#39;, &#39;18:00&#39;,
       &#39;19:00&#39;, &#39;20:00&#39;, &#39;21:00&#39;, &#39;22:00&#39;, &#39;23:00&#39;, &#39;00:00&#39;, &#39;01:00&#39;,
       &#39;02:00&#39;, &#39;03:00&#39;, &#39;04:00&#39;, &#39;05:00&#39;, &#39;06:00&#39;, &#39;07:00&#39;, &#39;08:00&#39;,
       &#39;09:00&#39;, &#39;10:00&#39;, &#39;11:00&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wind</span><span class="p">[</span><span class="s2">&quot;Hora&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wind</span><span class="p">[</span><span class="s2">&quot;Hora&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">.</span><span class="n">hour</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wind</span><span class="o">.</span><span class="n">Hora</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23,  0,  1,  2,  3,  4,
        5,  6,  7,  8,  9, 10, 11], dtype=int64)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;La información tiene </span><span class="si">{}</span><span class="s2"> filas y </span><span class="si">{}</span><span class="s2"> columnas&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wind</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wind</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>La información tiene 87693 filas y 13 columnas
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wind</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Hora</th>
      <td>87693.0</td>
      <td>11.506437</td>
      <td>6.932300</td>
      <td>0.0</td>
      <td>5.000000</td>
      <td>12.000000</td>
      <td>18.000000</td>
      <td>23.0</td>
    </tr>
    <tr>
      <th>Dirección del viento horaria</th>
      <td>87693.0</td>
      <td>0.405810</td>
      <td>0.686247</td>
      <td>-1.0</td>
      <td>-0.156434</td>
      <td>0.788011</td>
      <td>0.970296</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Velocidad horario del viento (m/s)</th>
      <td>87693.0</td>
      <td>2.466192</td>
      <td>1.313968</td>
      <td>0.0</td>
      <td>1.500000</td>
      <td>2.400000</td>
      <td>3.400000</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>Humedad rel. máx. hora anterior (AUT) ( %)</th>
      <td>87693.0</td>
      <td>69.058465</td>
      <td>19.640222</td>
      <td>12.0</td>
      <td>54.000000</td>
      <td>72.000000</td>
      <td>87.000000</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>Humedad rel. mín. hora anterior (AUT) ( %)</th>
      <td>87693.0</td>
      <td>63.176194</td>
      <td>20.166336</td>
      <td>10.0</td>
      <td>48.000000</td>
      <td>64.000000</td>
      <td>80.000000</td>
      <td>98.0</td>
    </tr>
    <tr>
      <th>Temperatura máx. hora anterior (AUT)(℃)</th>
      <td>87693.0</td>
      <td>21.921264</td>
      <td>3.721386</td>
      <td>9.2</td>
      <td>19.200000</td>
      <td>21.400000</td>
      <td>24.700000</td>
      <td>35.3</td>
    </tr>
    <tr>
      <th>Temperatura mín. hora anterior (AUT)( ℃)</th>
      <td>87693.0</td>
      <td>20.684570</td>
      <td>3.513744</td>
      <td>8.4</td>
      <td>18.400000</td>
      <td>20.200000</td>
      <td>23.100000</td>
      <td>34.4</td>
    </tr>
    <tr>
      <th>Humedad relativa horaria ( %)</th>
      <td>87693.0</td>
      <td>66.146682</td>
      <td>19.992327</td>
      <td>10.0</td>
      <td>51.000000</td>
      <td>68.000000</td>
      <td>84.000000</td>
      <td>99.0</td>
    </tr>
    <tr>
      <th>Presión atmosférica a nivel de estación, horaria (mB)</th>
      <td>87693.0</td>
      <td>887.251925</td>
      <td>4.012404</td>
      <td>863.4</td>
      <td>885.300000</td>
      <td>887.200000</td>
      <td>889.100000</td>
      <td>1023.5</td>
    </tr>
    <tr>
      <th>Precipitación total por hora (mm)</th>
      <td>87693.0</td>
      <td>0.160907</td>
      <td>1.307515</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>70.8</td>
    </tr>
    <tr>
      <th>Máxima ráfaga de viento (m/s)</th>
      <td>87693.0</td>
      <td>5.161076</td>
      <td>2.311157</td>
      <td>0.0</td>
      <td>3.400000</td>
      <td>5.000000</td>
      <td>6.800000</td>
      <td>24.3</td>
    </tr>
    <tr>
      <th>Presión atmosférica máx. hora anterior (AUT) (mB)</th>
      <td>87693.0</td>
      <td>887.580724</td>
      <td>3.646750</td>
      <td>865.3</td>
      <td>885.600000</td>
      <td>887.500000</td>
      <td>889.300000</td>
      <td>913.1</td>
    </tr>
    <tr>
      <th>Presión atmosférica mín. hora anterior (AUT) (mB)</th>
      <td>87693.0</td>
      <td>886.891093</td>
      <td>3.564539</td>
      <td>862.8</td>
      <td>885.000000</td>
      <td>886.900000</td>
      <td>888.800000</td>
      <td>910.9</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p><em><strong>Hora</strong></em>: La hora como sabemos toma valores de 0 a 23 que corresponden a las horas de un día (min y max).</p></li>
<li><p><em><strong>Dirección del viento horaria</strong></em>: La dirección va desde [-1 a 1], por los valores que toma la media y la mediana (0.4 y 0.78) podemos concluir que la dirección tiende a ser más en sentido positiva (+1).</p></li>
<li><p><em><strong>Velocidad horario del viento (m/s)</strong></em>: Es la variable objetivo, la cual depende de diversas condiciones meteorológicas. Para los datos en cuestión, tenemos una media de 2.46 (m/s), con una desviación de 1.31, se evidencia la presencia de valores extremos puesto que el 75% de los datos es menor a 3.4 m/s pero el máximo observado corresponde a 10 m/s. Así mismo, existe un leve sesgo hacia la derecha.</p></li>
<li><p><em><strong>Humedades</strong></em>: Van en un rango de 0 a 100 al presentarse en %. Corresponen a la humedad relativa horaria, humedad relativa mínima y máxima de la hora anterior; estas presentan datos similares y por la definición de las variables es muy probable que se encuentren correlacionadas.</p></li>
<li><p><em><strong>Temperatura</strong></em>: Corresponde a la temperatura máxima y mínima de la hora anterior, ambas presentan valores similares y también se podría decir que se encuentran correlacionadas. Los valores de temperatura oscilan entre 8.4 °C y 35.3°C.</p></li>
<li><p><em><strong>Presión atmosférica a nivel de estación, horaria (mB)</strong></em>: La media corresponde a 887 con una desviación estándar muy baja (4), se podría asumir que las mediciones se encuentran en lugares por encima del nivel del mar, puesto que al nivel del mar la presión es aprox 1013.25 milibares (mB).</p></li>
<li><p><em><strong>Precipitación total por hora (mm)</strong></em>: Podemos concluir que en al menos el 75% de las observaciones no había precipitación.</p></li>
<li><p><em><strong>Máxima ráfaga de viento (m/s)</strong></em>: Los valores se encuentran entre 0 y 24.3 m/s, con una media de 3.64 m/s.</p></li>
</ul>
<p>Se revisará la correlación más adelante.</p>
<p>A continuación revisaremos datos faltantes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Datos faltantes</span>
<span class="n">valores_faltantes</span> <span class="o">=</span> <span class="n">wind</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">porcentaje_faltantes</span> <span class="o">=</span> <span class="p">(</span><span class="n">valores_faltantes</span><span class="o">/</span><span class="n">wind</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
<span class="n">Faltantes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span> <span class="s1">&#39;Valores Faltantes&#39;</span><span class="p">:</span> <span class="n">valores_faltantes</span><span class="p">,</span> <span class="s1">&#39;Porcentaje Faltantes&#39;</span><span class="p">:</span> <span class="n">porcentaje_faltantes</span><span class="p">})</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s2">&quot;Porcentaje Faltantes&quot;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">Faltantes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Valores Faltantes</th>
      <th>Porcentaje Faltantes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Hora</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Dirección del viento horaria</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Velocidad horario del viento (m/s)</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Humedad rel. máx. hora anterior (AUT) ( %)</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Humedad rel. mín. hora anterior (AUT) ( %)</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Temperatura máx. hora anterior (AUT)(℃)</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Temperatura mín. hora anterior (AUT)( ℃)</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Humedad relativa horaria ( %)</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Presión atmosférica a nivel de estación, horaria (mB)</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Precipitación total por hora (mm)</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Máxima ráfaga de viento (m/s)</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Presión atmosférica máx. hora anterior (AUT) (mB)</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Presión atmosférica mín. hora anterior (AUT) (mB)</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>No se presentan datos faltantes en la información (:</p>
<p>Procederemos a revisar la distribución de la variable objetivo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">wind</span><span class="p">[</span><span class="s1">&#39;Velocidad horario del viento (m/s)&#39;</span><span class="p">],</span> <span class="n">bins</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Histograma de la velocidad del viento (m/s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Frecuencia&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0a2071ee7c7d402440986b4bceeabac8dfde7dcd4ec1c6c7aa45ad566a4f7248.png" src="_images/0a2071ee7c7d402440986b4bceeabac8dfde7dcd4ec1c6c7aa45ad566a4f7248.png" />
</div>
</div>
<p>La velocidad del viento presenta un sesgo hacia la derecha, como se observó en la sección anterior. Los valores más frecuenta están están entre 1.5 y 3 m/s.</p>
<p>A continuación, revisaremos la correlación de las variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">corr</span> <span class="o">=</span> <span class="n">wind</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">corr</span><span class="p">)</span>
<span class="n">mask</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">tril_indices_from</span><span class="p">(</span><span class="n">mask</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">font_scale</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="n">mask</span> <span class="o">=</span> <span class="n">mask</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;.1f&#39;</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">annot_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">},</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="_images/ed19b5cf9ff6ae4cdaa4654de642ef27d234830f93cbef4a0a52951c44b3face.png" src="_images/ed19b5cf9ff6ae4cdaa4654de642ef27d234830f93cbef4a0a52951c44b3face.png" />
</div>
</div>
<p>Se observa una gran relación entre las variables de presión, temperaturas y humedades (como era de esperarse, al tratarse de mediciones de la misma índole en períodos cercanos).
Así mismo, adelantandonos un poco la máxima ráfaga parece tener una gran influencia en la variable respuesta de velocidad del viento.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.outliers_influence</span> <span class="kn">import</span> <span class="n">variance_inflation_factor</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Calcular el VIF</span>
<span class="c1">#Quitar la columna de la variable respuesta del cálculo del VIF</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">wind</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Velocidad horario del viento (m/s)&quot;</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">X</span><span class="p">[</span><span class="s1">&#39;Intercept&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Muestra el DataFrame con los resultados del VIF</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                             Variable           VIF
0                                                Hora      1.535066
1                        Dirección del viento horaria      1.312001
2          Humedad rel. máx. hora anterior (AUT) ( %)     77.951749
3          Humedad rel. mín. hora anterior (AUT) ( %)     80.849151
4             Temperatura máx. hora anterior (AUT)(℃)     68.492554
5            Temperatura mín. hora anterior (AUT)( ℃)     57.283224
6                       Humedad relativa horaria ( %)     51.851514
7   Presión atmosférica a nivel de estación, horar...      4.900754
8                   Precipitación total por hora (mm)      1.122183
9                       Máxima ráfaga de viento (m/s)      1.325654
10  Presión atmosférica máx. hora anterior (AUT) (mB)     16.065974
11  Presión atmosférica mín. hora anterior (AUT) (mB)     16.499324
12                                          Intercept  83890.268999
</pre></div>
</div>
</div>
</div>
<p>Se procederá a eliminar la variable “Humedad rel. mín. hora anterior (AUT) ( %)” al tener el mayor valor de VIF. El intercepto no aplica porque fue creado sintéticamente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Calcular el VIF nuevamente sin la variable con mayor VIF</span>
<span class="c1">#Quitar la columna de la variable respuesta del cálculo del VIF</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">wind</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;Velocidad horario del viento (m/s)&quot;</span><span class="p">,</span><span class="s2">&quot;Humedad rel. mín. hora anterior (AUT) ( %)&quot;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">X</span><span class="p">[</span><span class="s1">&#39;Intercept&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Muestra el DataFrame con los resultados del VIF</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                             Variable           VIF
0                                                Hora      1.529583
1                        Dirección del viento horaria      1.311674
2          Humedad rel. máx. hora anterior (AUT) ( %)     41.754347
3             Temperatura máx. hora anterior (AUT)(℃)     30.834055
4            Temperatura mín. hora anterior (AUT)( ℃)     26.788844
5                       Humedad relativa horaria ( %)     46.388935
6   Presión atmosférica a nivel de estación, horar...      4.900632
7                   Precipitación total por hora (mm)      1.122181
8                       Máxima ráfaga de viento (m/s)      1.325499
9   Presión atmosférica máx. hora anterior (AUT) (mB)     16.044685
10  Presión atmosférica mín. hora anterior (AUT) (mB)     16.492733
11                                          Intercept  83673.291686
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Calcular el VIF nuevamente sin las dos variables</span>
<span class="c1">#Quitar la columna de la variable respuesta del cálculo del VIF</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">wind</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;Velocidad horario del viento (m/s)&quot;</span><span class="p">,</span><span class="s2">&quot;Humedad rel. mín. hora anterior (AUT) ( %)&quot;</span><span class="p">,</span> <span class="s2">&quot;Humedad relativa horaria ( %)&quot;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">X</span><span class="p">[</span><span class="s1">&#39;Intercept&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Muestra el DataFrame con los resultados del VIF</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                             Variable           VIF
0                                                Hora      1.529275
1                        Dirección del viento horaria      1.304670
2          Humedad rel. máx. hora anterior (AUT) ( %)      2.202492
3             Temperatura máx. hora anterior (AUT)(℃)     23.263067
4            Temperatura mín. hora anterior (AUT)( ℃)     21.399361
5   Presión atmosférica a nivel de estación, horar...      4.900185
6                   Precipitación total por hora (mm)      1.095933
7                       Máxima ráfaga de viento (m/s)      1.325465
8   Presión atmosférica máx. hora anterior (AUT) (mB)     16.031246
9   Presión atmosférica mín. hora anterior (AUT) (mB)     16.477030
10                                          Intercept  80340.737266
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Calcular el VIF nuevamente sin las tres variables</span>
<span class="c1">#Quitar la columna de la variable respuesta del cálculo del VIF</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">wind</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;Velocidad horario del viento (m/s)&quot;</span><span class="p">,</span><span class="s2">&quot;Humedad rel. mín. hora anterior (AUT) ( %)&quot;</span><span class="p">,</span> <span class="s2">&quot;Humedad relativa horaria ( %)&quot;</span><span class="p">,</span> 
    <span class="s2">&quot;Temperatura máx. hora anterior (AUT)(℃)&quot;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">X</span><span class="p">[</span><span class="s1">&#39;Intercept&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Muestra el DataFrame con los resultados del VIF</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                            Variable           VIF
0                                               Hora      1.459161
1                       Dirección del viento horaria      1.292438
2         Humedad rel. máx. hora anterior (AUT) ( %)      2.143679
3           Temperatura mín. hora anterior (AUT)( ℃)      2.222538
4  Presión atmosférica a nivel de estación, horar...      4.899953
5                  Precipitación total por hora (mm)      1.071249
6                      Máxima ráfaga de viento (m/s)      1.314166
7  Presión atmosférica máx. hora anterior (AUT) (mB)     15.705527
8  Presión atmosférica mín. hora anterior (AUT) (mB)     16.232106
9                                          Intercept  80075.448386
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Calcular el VIF nuevamente sin las cuatro variables</span>
<span class="c1">#Quitar la columna de la variable respuesta del cálculo del VIF</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">wind</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;Velocidad horario del viento (m/s)&quot;</span><span class="p">,</span><span class="s2">&quot;Humedad rel. mín. hora anterior (AUT) ( %)&quot;</span><span class="p">,</span> <span class="s2">&quot;Humedad relativa horaria ( %)&quot;</span><span class="p">,</span> 
    <span class="s2">&quot;Temperatura máx. hora anterior (AUT)(℃)&quot;</span><span class="p">,</span> <span class="s2">&quot;Presión atmosférica mín. hora anterior (AUT) (mB)&quot;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">X</span><span class="p">[</span><span class="s1">&#39;Intercept&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">vif_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;Variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
<span class="n">vif_data</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

<span class="c1"># Muestra el DataFrame con los resultados del VIF</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vif_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                            Variable           VIF
0                                               Hora      1.444186
1                       Dirección del viento horaria      1.288093
2         Humedad rel. máx. hora anterior (AUT) ( %)      2.135348
3           Temperatura mín. hora anterior (AUT)( ℃)      2.215522
4  Presión atmosférica a nivel de estación, horar...      4.552489
5                  Precipitación total por hora (mm)      1.067204
6                      Máxima ráfaga de viento (m/s)      1.314117
7  Presión atmosférica máx. hora anterior (AUT) (mB)      4.721712
8                                          Intercept  75664.101989
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wind</span> <span class="o">=</span> <span class="n">wind</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;Humedad rel. mín. hora anterior (AUT) ( %)&quot;</span><span class="p">,</span> <span class="s2">&quot;Humedad relativa horaria ( %)&quot;</span><span class="p">,</span> 
    <span class="s2">&quot;Temperatura máx. hora anterior (AUT)(℃)&quot;</span><span class="p">,</span> <span class="s2">&quot;Presión atmosférica mín. hora anterior (AUT) (mB)&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">wind</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Hora</th>
      <th>Dirección del viento horaria</th>
      <th>Velocidad horario del viento (m/s)</th>
      <th>Humedad rel. máx. hora anterior (AUT) ( %)</th>
      <th>Temperatura mín. hora anterior (AUT)( ℃)</th>
      <th>Presión atmosférica a nivel de estación, horaria (mB)</th>
      <th>Precipitación total por hora (mm)</th>
      <th>Máxima ráfaga de viento (m/s)</th>
      <th>Presión atmosférica máx. hora anterior (AUT) (mB)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12</td>
      <td>0.809017</td>
      <td>1.8</td>
      <td>69.0</td>
      <td>20.7</td>
      <td>888.2</td>
      <td>0.0</td>
      <td>3.8</td>
      <td>888.2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13</td>
      <td>0.965926</td>
      <td>2.7</td>
      <td>62.0</td>
      <td>22.5</td>
      <td>888.4</td>
      <td>0.0</td>
      <td>4.7</td>
      <td>888.4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>14</td>
      <td>0.891007</td>
      <td>2.0</td>
      <td>56.0</td>
      <td>24.3</td>
      <td>888.1</td>
      <td>0.0</td>
      <td>4.9</td>
      <td>888.4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15</td>
      <td>0.848048</td>
      <td>2.5</td>
      <td>52.0</td>
      <td>25.0</td>
      <td>887.4</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>888.1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>16</td>
      <td>0.224951</td>
      <td>2.4</td>
      <td>50.0</td>
      <td>25.5</td>
      <td>886.5</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>887.4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">corr</span> <span class="o">=</span> <span class="n">wind</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">corr</span><span class="p">)</span>
<span class="n">mask</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">triu_indices_from</span><span class="p">(</span><span class="n">mask</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">font_scale</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="n">mask</span> <span class="o">=</span> <span class="n">mask</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;.1f&#39;</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">annot_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">},</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="_images/1025fca10e2095251cff1a53b983cf4e4e43112c9bf74e1f4226885e079a0a11.png" src="_images/1025fca10e2095251cff1a53b983cf4e4e43112c9bf74e1f4226885e079a0a11.png" />
</div>
</div>
<p>A criterio propio eliminaré la variable Presión atmosférica máx. hora anterior (AUT)(mB), al seguir presentando una alta correlación. No se eliminó con el VIF porque este mide la relación de esa variable con dos o más.</p>
<p>Después de revisar el Factor de Inflación de Varianza, solo trabajaremos con 7 columnas (aquellas que tuvieron un VIF &lt;5).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wind</span> <span class="o">=</span> <span class="n">wind</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Presión atmosférica máx. hora anterior (AUT) (mB)&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">wind</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Hora</th>
      <th>Dirección del viento horaria</th>
      <th>Velocidad horario del viento (m/s)</th>
      <th>Humedad rel. máx. hora anterior (AUT) ( %)</th>
      <th>Temperatura mín. hora anterior (AUT)( ℃)</th>
      <th>Presión atmosférica a nivel de estación, horaria (mB)</th>
      <th>Precipitación total por hora (mm)</th>
      <th>Máxima ráfaga de viento (m/s)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12</td>
      <td>0.809017</td>
      <td>1.8</td>
      <td>69.0</td>
      <td>20.7</td>
      <td>888.2</td>
      <td>0.0</td>
      <td>3.8</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13</td>
      <td>0.965926</td>
      <td>2.7</td>
      <td>62.0</td>
      <td>22.5</td>
      <td>888.4</td>
      <td>0.0</td>
      <td>4.7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>14</td>
      <td>0.891007</td>
      <td>2.0</td>
      <td>56.0</td>
      <td>24.3</td>
      <td>888.1</td>
      <td>0.0</td>
      <td>4.9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15</td>
      <td>0.848048</td>
      <td>2.5</td>
      <td>52.0</td>
      <td>25.0</td>
      <td>887.4</td>
      <td>0.0</td>
      <td>5.8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>16</td>
      <td>0.224951</td>
      <td>2.4</td>
      <td>50.0</td>
      <td>25.5</td>
      <td>886.5</td>
      <td>0.0</td>
      <td>5.8</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">font_scale</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">wind</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">corner</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">7.0</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mf">1.4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.PairGrid at 0x1cbbcf438e0&gt;
</pre></div>
</div>
<img alt="_images/bffdd74f023f57bfec20f16bd53592b2a186191834a0f923ced66ed3a382232e.png" src="_images/bffdd74f023f57bfec20f16bd53592b2a186191834a0f923ced66ed3a382232e.png" />
</div>
</div>
<p>El gráfico de dispersión muestra que de acuerdo a la hora del día las mediciones meteorológicas varían.</p>
<p>Por otro lado, la dirección del viento no parece verse afectada por las otras variables (se abarca todo el rango de -1 a 1 de manera al variar los valores de una misma variable).</p>
<p>La presión atmósferica presenta algunos valores atípicos.</p>
<p>Revisemos los histogramas y diagramas de caja de las variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">font_scale</span><span class="o">=</span><span class="mf">1.8</span><span class="p">)</span>
<span class="n">wind</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span> <span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">30</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="mi">24</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4b0ffba80d76b888048db7abeee17d3c7c0c19443cbe75b54e1d395a54434a40.png" src="_images/4b0ffba80d76b888048db7abeee17d3c7c0c19443cbe75b54e1d395a54434a40.png" />
</div>
</div>
<ul class="simple">
<li><p>Se cuenta con obseervaciones en toda la zona horaria, y de manera balanceada a lo largo del día.</p></li>
<li><p>La dirección del viento predominante es la +1.</p></li>
<li><p>Aumenta la frecuencia de la humedad a medida que se incrementa el %.</p></li>
<li><p>La temperatura más frecuente está al rededor de los 20°C.</p></li>
<li><p>Los valores de presión atomósferica son bastante cercanos entre sí.</p></li>
<li><p>En esta área no suele haber precipitaciones.</p></li>
<li><p>La máxima ráfaga suele estar en valores inferiores a 10 m/s.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">wind</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>  
    <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">wind</span><span class="p">[</span><span class="n">column</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>  <span class="c1"># Rotación de etiquetas del eje x si es necesario</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>  <span class="c1"># Ajusta la disposición de los subplots</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a3e7d60d29d5656f4dd353165c4b3e988ec0cd26e1caabcdc910d6c0a99c7493.png" src="_images/a3e7d60d29d5656f4dd353165c4b3e988ec0cd26e1caabcdc910d6c0a99c7493.png" />
</div>
</div>
<p>Los diagramas de caja complementan toda la información observada hasta el momento, observamos valores altos y poco frecuentes en precipitación (esta región parece caracterizarse por pocas lluvias), en presiones atmósfericas, en temperaturas tanto altas como bajas.
Se observa poca varibilidad en la presión atmósferica.</p>
</section>
<section id="modelado">
<h2><strong>MODELADO</strong><a class="headerlink" href="#modelado" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">linear_model</span>
<span class="kn">import</span> <span class="nn">xgboost</span> <span class="k">as</span> <span class="nn">xgb</span>
<span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="kn">import</span> <span class="n">MLPClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVR</span>
<span class="kn">import</span> <span class="nn">math</span>
</pre></div>
</div>
</div>
</div>
<p>Debido a la gran cantidad de datos, se utilizará solo la última mitad de estos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Se dividen los datos en training y testing</span>
<span class="n">wind_training</span> <span class="o">=</span> <span class="n">wind</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">wind</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">wind_testing</span> <span class="o">=</span> <span class="n">wind</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Se calcula el número de datos que va a tener la nueva base de datos de wind para el modelado</span>
<span class="c1">#Por cuestiones de computo se trabajará con la mitad de los datos</span>
<span class="n">particiones_24</span><span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wind_training</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="mi">24</span><span class="p">)</span>
<span class="n">new_wind</span> <span class="o">=</span> <span class="n">wind_training</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="n">particiones_24</span> <span class="o">*</span><span class="mi">24</span><span class="p">)</span>
<span class="n">new_wind</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(43824, 8)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wind_x</span> <span class="o">=</span> <span class="n">new_wind</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">]]</span>
<span class="n">wind_y</span> <span class="o">=</span> <span class="n">new_wind</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>

<span class="n">wind_x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Hora</th>
      <th>Dirección del viento horaria</th>
      <th>Humedad rel. máx. hora anterior (AUT) ( %)</th>
      <th>Temperatura mín. hora anterior (AUT)( ℃)</th>
      <th>Presión atmosférica a nivel de estación, horaria (mB)</th>
      <th>Precipitación total por hora (mm)</th>
      <th>Máxima ráfaga de viento (m/s)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>43845</th>
      <td>18</td>
      <td>0.997564</td>
      <td>29.0</td>
      <td>29.2</td>
      <td>884.4</td>
      <td>0.0</td>
      <td>7.1</td>
    </tr>
    <tr>
      <th>43846</th>
      <td>19</td>
      <td>0.999848</td>
      <td>29.0</td>
      <td>29.2</td>
      <td>883.9</td>
      <td>0.0</td>
      <td>6.2</td>
    </tr>
    <tr>
      <th>43847</th>
      <td>20</td>
      <td>0.857167</td>
      <td>30.0</td>
      <td>28.8</td>
      <td>883.7</td>
      <td>0.0</td>
      <td>5.9</td>
    </tr>
    <tr>
      <th>43848</th>
      <td>22</td>
      <td>0.601815</td>
      <td>36.0</td>
      <td>26.2</td>
      <td>884.3</td>
      <td>0.0</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>43849</th>
      <td>23</td>
      <td>0.500000</td>
      <td>39.0</td>
      <td>25.1</td>
      <td>884.8</td>
      <td>0.0</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>87664</th>
      <td>19</td>
      <td>-0.453990</td>
      <td>85.0</td>
      <td>21.5</td>
      <td>878.0</td>
      <td>0.0</td>
      <td>9.2</td>
    </tr>
    <tr>
      <th>87665</th>
      <td>20</td>
      <td>-0.559193</td>
      <td>84.0</td>
      <td>21.1</td>
      <td>878.1</td>
      <td>0.0</td>
      <td>7.8</td>
    </tr>
    <tr>
      <th>87666</th>
      <td>21</td>
      <td>-0.629320</td>
      <td>85.0</td>
      <td>20.6</td>
      <td>878.4</td>
      <td>0.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>87667</th>
      <td>22</td>
      <td>-0.891007</td>
      <td>90.0</td>
      <td>19.9</td>
      <td>879.1</td>
      <td>0.0</td>
      <td>5.2</td>
    </tr>
    <tr>
      <th>87668</th>
      <td>23</td>
      <td>-0.743145</td>
      <td>91.0</td>
      <td>19.0</td>
      <td>879.6</td>
      <td>0.0</td>
      <td>5.6</td>
    </tr>
  </tbody>
</table>
<p>43824 rows × 7 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best_rmse</span> <span class="o">=</span> <span class="mi">10000000</span>

<span class="k">for</span> <span class="n">nei</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>

    <span class="n">knn</span><span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="n">nei</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> vecinos&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nei</span><span class="p">))</span>
    
    <span class="n">all_rmse_values</span> <span class="o">=</span><span class="p">[]</span>
    <span class="n">all_r2_values</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">all_mape_values</span> <span class="o">=</span> <span class="p">[]</span>
    

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_wind</span><span class="p">)</span><span class="o">-</span><span class="mi">24</span><span class="p">,</span> <span class="mi">24</span><span class="p">):</span>
        
        <span class="c1"># Toma los primeros datos en training con incrementos de 24</span>
        <span class="n">training_segment_x</span> <span class="o">=</span> <span class="n">wind_x</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
        <span class="n">training_segment_y</span> <span class="o">=</span> <span class="n">wind_y</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>

        
        <span class="c1">#Escalar el training</span>
        <span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">(</span><span class="n">feature_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_segment_x</span><span class="p">)</span>
        <span class="n">training_segment_x_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">training_segment_x</span><span class="p">)</span>
        
        
        <span class="c1"># Toma los siguientes 24 datos en &#39;validation&#39;</span>
        <span class="n">validation_segment_x</span> <span class="o">=</span> <span class="n">wind_x</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">24</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">48</span><span class="p">]</span>
        <span class="n">validation_segment_y</span> <span class="o">=</span> <span class="n">wind_y</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">24</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">48</span><span class="p">]</span>
        
   
        <span class="n">knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_segment_x_scaled</span><span class="p">,</span> <span class="n">training_segment_y</span><span class="p">)</span>
        <span class="c1">#Para la predicción se escala el conjunto de validación con el resultado del training para evitar la fuga de datos</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">knn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">validation_segment_x</span><span class="p">))</span>
        
        <span class="c1">#RMSE</span>
        <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">validation_segment_y</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
        <span class="n">all_rmse_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
    
        
        <span class="c1">#R2</span>
        <span class="n">r2</span><span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">validation_segment_y</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
        <span class="n">all_r2_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r2</span><span class="p">)</span>
        
        
        <span class="c1">#MAPE corregido por aquellos valores y en la validación que son 0</span>
        <span class="n">non_zero_indices</span> <span class="o">=</span> <span class="n">validation_segment_y</span> <span class="o">!=</span> <span class="mi">0</span>
        <span class="n">absolute_errors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">validation_segment_y</span> <span class="o">-</span> <span class="n">predictions</span><span class="p">)</span>
        <span class="n">absolute_errors</span> <span class="o">=</span> <span class="n">absolute_errors</span><span class="p">[</span><span class="n">non_zero_indices</span><span class="p">]</span>       
        <span class="n">mape</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">absolute_errors</span> <span class="o">/</span> <span class="n">validation_segment_y</span><span class="p">[</span><span class="n">non_zero_indices</span><span class="p">]))</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="n">all_mape_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mape</span><span class="p">)</span>
        
        
    <span class="n">r2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">all_r2_values</span><span class="p">)</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">all_rmse_values</span><span class="p">)</span>
    <span class="n">mape</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">all_mape_values</span><span class="p">)</span>
    
    
    <span class="k">if</span> <span class="n">rmse</span> <span class="o">&lt;</span> <span class="n">best_rmse</span><span class="p">:</span>
        <span class="n">best_rmse</span> <span class="o">=</span> <span class="n">rmse</span>
        <span class="n">r2_def</span> <span class="o">=</span> <span class="n">r2</span>
        <span class="n">mape_def</span> <span class="o">=</span> <span class="n">mape</span>
        <span class="n">best_parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;neighbors&#39;</span><span class="p">:</span> <span class="n">nei</span><span class="p">}</span>
        
        

<span class="nb">print</span><span class="p">(</span><span class="n">best_parameters</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">best_rmse</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r2_def</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mape_def</span><span class="p">)</span>

<span class="n">scores_knn</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;knn&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">mape_def</span><span class="p">,</span> <span class="n">best_rmse</span><span class="p">,</span> <span class="n">r2_def</span><span class="p">]}</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1 vecinos
2 vecinos
3 vecinos
4 vecinos
5 vecinos
6 vecinos
7 vecinos
8 vecinos
9 vecinos
10 vecinos
{&#39;neighbors&#39;: 10}
0.6156483397403705
0.5614265882221974
36.41950247171557
</pre></div>
</div>
</div>
</div>
<p>El valor de MAPE da inf puesto que el divisor “validation_segment_y” toma valores de cero (velocidad del viento), esta métrica no es muy recomendable para este caso.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scores_knn</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;knn&#39;: [36.41950247171557, 0.6156483397403705, 0.5614265882221974]}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best_rmse</span> <span class="o">=</span> <span class="mi">10000000</span>


<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.000001</span><span class="p">,</span><span class="mf">0.0001</span><span class="p">,</span><span class="mf">0.001</span><span class="p">,</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">]:</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> alpha&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
    
    <span class="n">ridge</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">fit_intercept</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    
    <span class="n">all_rmse_values</span> <span class="o">=</span><span class="p">[]</span>
    <span class="n">all_r2_values</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">all_mape_values</span> <span class="o">=</span> <span class="p">[]</span>
    

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_wind</span><span class="p">)</span><span class="o">-</span><span class="mi">24</span><span class="p">,</span> <span class="mi">24</span><span class="p">):</span>
        
        <span class="c1"># Toma los primeros datos en training con incrementos de 24</span>
        <span class="n">training_segment_x</span> <span class="o">=</span> <span class="n">wind_x</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
        <span class="n">training_segment_y</span> <span class="o">=</span> <span class="n">wind_y</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
        
        <span class="c1">#Escalar el training</span>
        <span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">(</span><span class="n">feature_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_segment_x</span><span class="p">)</span>
        <span class="n">training_segment_x_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">training_segment_x</span><span class="p">)</span>
        
        
        <span class="c1"># Toma los siguientes 24 datos en &#39;validation&#39;</span>
        <span class="n">validation_segment_x</span> <span class="o">=</span> <span class="n">wind_x</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">24</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">48</span><span class="p">]</span>
        <span class="n">validation_segment_y</span> <span class="o">=</span> <span class="n">wind_y</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">24</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">48</span><span class="p">]</span>
   
        <span class="n">ridge</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_segment_x_scaled</span><span class="p">,</span> <span class="n">training_segment_y</span><span class="p">)</span>
        <span class="c1">#Para la predicción se escala el conjunto de validación con el resultado del training para evitar la fuga de datos</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">ridge</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">validation_segment_x</span><span class="p">))</span>
        
        <span class="c1">#RMSE</span>
        <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">validation_segment_y</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
        <span class="n">all_rmse_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
    
        
        <span class="c1">#R2</span>
        <span class="n">r2</span><span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">validation_segment_y</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
        <span class="n">all_r2_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r2</span><span class="p">)</span>

        
        <span class="c1">#MAPE corregido por aquellos valores y en la validación que son 0</span>
        
        <span class="n">non_zero_indices</span> <span class="o">=</span> <span class="n">validation_segment_y</span> <span class="o">!=</span> <span class="mi">0</span>
        <span class="n">absolute_errors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">validation_segment_y</span> <span class="o">-</span> <span class="n">predictions</span><span class="p">)</span>
        <span class="n">absolute_errors</span> <span class="o">=</span> <span class="n">absolute_errors</span><span class="p">[</span><span class="n">non_zero_indices</span><span class="p">]</span>       
        <span class="n">mape</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">absolute_errors</span> <span class="o">/</span> <span class="n">validation_segment_y</span><span class="p">[</span><span class="n">non_zero_indices</span><span class="p">]))</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="n">all_mape_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mape</span><span class="p">)</span>
        
        
    <span class="n">r2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">all_r2_values</span><span class="p">)</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">all_rmse_values</span><span class="p">)</span>
    <span class="n">mape</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">all_mape_values</span><span class="p">)</span>
        
        
    <span class="k">if</span> <span class="n">rmse</span> <span class="o">&lt;</span> <span class="n">best_rmse</span><span class="p">:</span>
        <span class="n">best_rmse</span> <span class="o">=</span> <span class="n">rmse</span>
        <span class="n">r2_def</span> <span class="o">=</span> <span class="n">r2</span>
        <span class="n">mape_def</span> <span class="o">=</span> <span class="n">mape</span>
        <span class="n">best_parameters_ridge</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="n">a</span><span class="p">}</span>
        
        

<span class="nb">print</span><span class="p">(</span><span class="n">best_parameters_ridge</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">best_rmse</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r2_def</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mape_def</span><span class="p">)</span>
<span class="n">scores_ridge</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Ridge&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">mape_def</span><span class="p">,</span> <span class="n">best_rmse</span><span class="p">,</span> <span class="n">r2_def</span><span class="p">]}</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1e-06 alpha
0.0001 alpha
0.001 alpha
0.01 alpha
0.1 alpha
1 alpha
10 alpha
{&#39;alpha&#39;: 1e-06}
0.5927235651236987
0.5887166863288078
34.384306154975
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scores_ridge</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Ridge&#39;: [34.384306154975, 0.5927235651236987, 0.5887166863288078]}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best_rmse</span> <span class="o">=</span> <span class="mi">10000000</span>

<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span>  <span class="p">[</span><span class="mf">0.00001</span><span class="p">,</span><span class="mf">0.0001</span><span class="p">,</span><span class="mf">0.001</span><span class="p">,</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> alpha&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>    

    <span class="n">lasso</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">fit_intercept</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    
    <span class="n">all_rmse_values</span> <span class="o">=</span><span class="p">[]</span>
    <span class="n">all_r2_values</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">all_mape_values</span> <span class="o">=</span> <span class="p">[]</span>
    

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_wind</span><span class="p">)</span><span class="o">-</span><span class="mi">24</span><span class="p">,</span> <span class="mi">24</span><span class="p">):</span>
        
        <span class="c1"># Toma los primeros datos en training con incrementos de 24</span>
        <span class="n">training_segment_x</span> <span class="o">=</span> <span class="n">wind_x</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
        <span class="n">training_segment_y</span> <span class="o">=</span> <span class="n">wind_y</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
        
        <span class="c1">#Escalar el training</span>
        <span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">(</span><span class="n">feature_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_segment_x</span><span class="p">)</span>
        <span class="n">training_segment_x_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">training_segment_x</span><span class="p">)</span>
        
        
        <span class="c1"># Toma los siguientes 24 datos en &#39;validation&#39;</span>
        <span class="n">validation_segment_x</span> <span class="o">=</span> <span class="n">wind_x</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">24</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">48</span><span class="p">]</span>
        <span class="n">validation_segment_y</span> <span class="o">=</span> <span class="n">wind_y</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">24</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">48</span><span class="p">]</span>
   
        <span class="n">lasso</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_segment_x_scaled</span><span class="p">,</span> <span class="n">training_segment_y</span><span class="p">)</span>
        <span class="c1">#Para la predicción se escala el conjunto de validación con el resultado del training para evitar la fuga de datos</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">lasso</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">validation_segment_x</span><span class="p">))</span>
        
        <span class="c1">#RMSE</span>
        <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">validation_segment_y</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
        <span class="n">all_rmse_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
    
        
        <span class="c1">#R2</span>
        <span class="n">r2</span><span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">validation_segment_y</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
        <span class="n">all_r2_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r2</span><span class="p">)</span>

        
        <span class="c1">#MAPE corregido por aquellos valores y en la validación que son 0</span>
        
        <span class="n">non_zero_indices</span> <span class="o">=</span> <span class="n">validation_segment_y</span> <span class="o">!=</span> <span class="mi">0</span>
        <span class="n">absolute_errors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">validation_segment_y</span> <span class="o">-</span> <span class="n">predictions</span><span class="p">)</span>
        <span class="n">absolute_errors</span> <span class="o">=</span> <span class="n">absolute_errors</span><span class="p">[</span><span class="n">non_zero_indices</span><span class="p">]</span>       
        <span class="n">mape</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">absolute_errors</span> <span class="o">/</span> <span class="n">validation_segment_y</span><span class="p">[</span><span class="n">non_zero_indices</span><span class="p">]))</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="n">all_mape_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mape</span><span class="p">)</span>
        
        
    <span class="n">r2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">all_r2_values</span><span class="p">)</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">all_rmse_values</span><span class="p">)</span>
    <span class="n">mape</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">all_mape_values</span><span class="p">)</span>
        
        
    <span class="k">if</span> <span class="n">rmse</span> <span class="o">&lt;</span> <span class="n">best_rmse</span><span class="p">:</span>
        <span class="n">best_rmse</span> <span class="o">=</span> <span class="n">rmse</span>
        <span class="n">r2_def</span> <span class="o">=</span> <span class="n">r2</span>
        <span class="n">mape_def</span> <span class="o">=</span> <span class="n">mape</span>
        <span class="n">best_parameters_lasso</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="n">a</span><span class="p">}</span>
        
        

<span class="nb">print</span><span class="p">(</span><span class="n">best_parameters_lasso</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">best_rmse</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r2_def</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mape_def</span><span class="p">)</span>
<span class="n">scores_lasso</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Lasso&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">mape_def</span><span class="p">,</span> <span class="n">best_rmse</span><span class="p">,</span> <span class="n">r2_def</span><span class="p">]}</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1e-05 alpha
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0001 alpha
0.001 alpha
0.01 alpha
0.1 alpha
1 alpha
{&#39;alpha&#39;: 0.0001}
0.5927006299542638
0.5889053044959749
34.40252077491132
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scores_lasso</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Lasso&#39;: [34.40252077491132, 0.5927006299542638, 0.5889053044959749]}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#XGBoost</span>
<span class="c1">#No requiere estandarizar los datos</span>
<span class="n">best_rmse</span> <span class="o">=</span> <span class="mi">10000000</span>

<span class="k">for</span> <span class="n">arboles</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> árboles&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">arboles</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">learning</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">1</span><span class="p">]:</span>
        
        <span class="k">for</span> <span class="n">max_depth</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
         
            <span class="n">XGB</span> <span class="o">=</span> <span class="n">xgb</span><span class="o">.</span><span class="n">XGBRegressor</span><span class="p">(</span><span class="n">learning_rate</span> <span class="o">=</span> <span class="n">learning</span><span class="p">,</span> <span class="n">n_estimators</span> <span class="o">=</span> <span class="n">arboles</span><span class="p">,</span> <span class="n">max_depth</span> <span class="o">=</span> <span class="n">max_depth</span><span class="p">)</span>
            
            <span class="n">all_rmse_values</span> <span class="o">=</span><span class="p">[]</span>
            <span class="n">all_r2_values</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">all_mape_values</span> <span class="o">=</span> <span class="p">[]</span>
            

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">new_wind</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="mi">24</span><span class="p">,</span> <span class="mi">24</span><span class="p">):</span>
                
                <span class="c1"># Toma los primeros datos en training con incrementos de 24</span>
                <span class="n">training_segment_x</span> <span class="o">=</span> <span class="n">wind_x</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
                <span class="n">training_segment_y</span> <span class="o">=</span> <span class="n">wind_y</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
                
                
                <span class="c1"># Toma los siguientes 24 datos en &#39;validation&#39;</span>
                <span class="n">validation_segment_x</span> <span class="o">=</span> <span class="n">wind_x</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">24</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">48</span><span class="p">]</span>
                <span class="n">validation_segment_y</span> <span class="o">=</span> <span class="n">wind_y</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">24</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">48</span><span class="p">]</span>
        
                <span class="n">XGB</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_segment_x</span><span class="p">,</span> <span class="n">training_segment_y</span><span class="p">)</span>

                <span class="n">predictions</span> <span class="o">=</span> <span class="n">XGB</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">validation_segment_x</span><span class="p">)</span>
                
                <span class="c1">#RMSE</span>
                <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">validation_segment_y</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
                <span class="n">all_rmse_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
    
        
                <span class="c1">#R2</span>
                <span class="n">r2</span><span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">validation_segment_y</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
                <span class="n">all_r2_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r2</span><span class="p">)</span>

        
                <span class="c1">#MAPE corregido por aquellos valores y en la validación que son 0</span>
                
                <span class="n">non_zero_indices</span> <span class="o">=</span> <span class="n">validation_segment_y</span> <span class="o">!=</span> <span class="mi">0</span>
                <span class="n">absolute_errors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">validation_segment_y</span> <span class="o">-</span> <span class="n">predictions</span><span class="p">)</span>
                <span class="n">absolute_errors</span> <span class="o">=</span> <span class="n">absolute_errors</span><span class="p">[</span><span class="n">non_zero_indices</span><span class="p">]</span>       
                <span class="n">mape</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">absolute_errors</span> <span class="o">/</span> <span class="n">validation_segment_y</span><span class="p">[</span><span class="n">non_zero_indices</span><span class="p">]))</span> <span class="o">*</span> <span class="mi">100</span>
                <span class="n">all_mape_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mape</span><span class="p">)</span>
                
            
            <span class="n">r2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">all_r2_values</span><span class="p">)</span>
            <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">all_rmse_values</span><span class="p">)</span>
            <span class="n">mape</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">all_mape_values</span><span class="p">)</span>
                
            <span class="k">if</span> <span class="n">rmse</span> <span class="o">&lt;</span> <span class="n">best_rmse</span><span class="p">:</span>
                <span class="n">best_rmse</span> <span class="o">=</span> <span class="n">rmse</span>
                <span class="n">r2_def</span> <span class="o">=</span> <span class="n">r2</span>
                <span class="n">mape_def</span> <span class="o">=</span> <span class="n">mape</span>
                <span class="n">best_parameters_XGB</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="n">arboles</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="n">learning</span><span class="p">,</span> <span class="s2">&quot;max_depth&quot;</span><span class="p">:</span> <span class="n">max_depth</span><span class="p">}</span>
                
                

<span class="nb">print</span><span class="p">(</span><span class="n">best_parameters_XGB</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">best_rmse</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r2_def</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mape_def</span><span class="p">)</span>
<span class="n">scores_xgb</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;XGB&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">mape_def</span><span class="p">,</span> <span class="n">best_rmse</span><span class="p">,</span> <span class="n">r2_def</span><span class="p">]}</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2 árboles
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 árboles
4 árboles
5 árboles
{&#39;n_estimators&#39;: 5, &#39;learning_rate&#39;: 1, &#39;max_depth&#39;: 3}
0.6041179919641563
0.5931351518058534
35.37884980486454
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scores_xgb</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;XGB&#39;: [35.37884980486454, 0.6041179919641563, 0.5931351518058534]}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##SVM</span>
<span class="c1">## Para este modelo por tiempos de procesamiento se disminuyó más el número de filas</span>
<span class="n">best_rmse</span> <span class="o">=</span> <span class="mi">10000000</span>

<span class="k">for</span> <span class="n">C</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">]:</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> regularización&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">C</span><span class="p">))</span>
            
    <span class="k">for</span> <span class="n">gamma</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> gamma&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gamma</span><span class="p">))</span>
                
        <span class="n">SVR_model</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span> <span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="n">C</span><span class="p">)</span>
                
        <span class="n">all_rmse_values</span> <span class="o">=</span><span class="p">[]</span>
        <span class="n">all_r2_values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">all_mape_values</span> <span class="o">=</span> <span class="p">[]</span>
                
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">new_wind</span><span class="p">)</span><span class="o">//</span><span class="mi">16</span><span class="p">)</span><span class="o">-</span><span class="mi">24</span><span class="p">,</span> <span class="mi">24</span><span class="p">):</span>
         
            <span class="c1"># Toma los primeros datos en training con incrementos de 24</span>
            <span class="n">training_segment_x</span> <span class="o">=</span> <span class="n">wind_x</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
            <span class="n">training_segment_y</span> <span class="o">=</span> <span class="n">wind_y</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
            
            <span class="c1">#Escalar el training</span>
            <span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">(</span><span class="n">feature_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_segment_x</span><span class="p">)</span>
            <span class="n">training_segment_x_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">training_segment_x</span><span class="p">)</span>
                
            <span class="c1"># Toma los siguientes 24 datos en &#39;validation&#39;</span>
            <span class="n">validation_segment_x</span> <span class="o">=</span> <span class="n">wind_x</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">24</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">48</span><span class="p">]</span>
            <span class="n">validation_segment_y</span> <span class="o">=</span> <span class="n">wind_y</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">24</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">48</span><span class="p">]</span>
                        
                
            <span class="n">SVR_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_segment_x_scaled</span><span class="p">,</span> <span class="n">training_segment_y</span><span class="p">)</span>
            <span class="c1">#Para la predicción se escala el conjunto de validación con el resultado del training para evitar la fuga de datos</span>
            <span class="n">predictions</span> <span class="o">=</span> <span class="n">SVR_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">validation_segment_x</span><span class="p">))</span>
                        
            <span class="c1">#RMSE</span>
            <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">validation_segment_y</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
            <span class="n">all_rmse_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>       
                        
            <span class="c1">#R2</span>
            <span class="n">r2</span><span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">validation_segment_y</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
            <span class="n">all_r2_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r2</span><span class="p">)</span>
                        
            <span class="c1">#MAPE corregido por aquellos valores y en la validación que son 0</span>
            
            <span class="n">non_zero_indices</span> <span class="o">=</span> <span class="n">validation_segment_y</span> <span class="o">!=</span> <span class="mi">0</span>
            <span class="n">absolute_errors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">validation_segment_y</span> <span class="o">-</span> <span class="n">predictions</span><span class="p">)</span>
            <span class="n">absolute_errors</span> <span class="o">=</span> <span class="n">absolute_errors</span><span class="p">[</span><span class="n">non_zero_indices</span><span class="p">]</span>       
            <span class="n">mape</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">absolute_errors</span> <span class="o">/</span> <span class="n">validation_segment_y</span><span class="p">[</span><span class="n">non_zero_indices</span><span class="p">]))</span> <span class="o">*</span> <span class="mi">100</span>
            <span class="n">all_mape_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mape</span><span class="p">)</span>
                            
        <span class="n">r2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">all_r2_values</span><span class="p">)</span>
        <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">all_rmse_values</span><span class="p">)</span>
        <span class="n">mape</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">all_mape_values</span><span class="p">)</span>
            
            
        <span class="k">if</span> <span class="n">rmse</span> <span class="o">&lt;</span> <span class="n">best_rmse</span><span class="p">:</span>
            <span class="n">best_rmse</span> <span class="o">=</span> <span class="n">rmse</span>
            <span class="n">r2_def</span> <span class="o">=</span> <span class="n">r2</span>
            <span class="n">mape_def</span> <span class="o">=</span> <span class="n">mape</span>
            <span class="n">best_parameters_SVR</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="n">C</span><span class="p">,</span> <span class="s2">&quot;gamma&quot;</span><span class="p">:</span> <span class="n">gamma</span><span class="p">}</span>
                        
                        
<span class="nb">print</span><span class="p">(</span><span class="n">best_parameters_SVR</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">best_rmse</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r2_def</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mape_def</span><span class="p">)</span>
<span class="n">scores_svr</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;SVR&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">mape_def</span><span class="p">,</span> <span class="n">best_rmse</span><span class="p">,</span> <span class="n">r2_def</span><span class="p">]}</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.1 regularización
0.01 gamma
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.1 gamma
1 gamma
1 regularización
0.01 gamma
0.1 gamma
1 gamma
10 regularización
0.01 gamma
0.1 gamma
1 gamma
{&#39;C&#39;: 1, &#39;gamma&#39;: 1}
0.645847143087297
0.5747360127629626
41.84244372349804
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scores_svr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;SVR&#39;: [41.84244372349804, 0.645847143087297, 0.5747360127629626]}
</pre></div>
</div>
</div>
</div>
<p>Para el Multilayer Perceptron al ser un problema de regresión, la capa de salida (activarion_out) es “identity” que funciona como una salida lineal, devuelve la entrada a la neurona sin ninguna transformación.</p>
<p>Para las capas ocultas (activation) se usarán diferentes funciones de activación como identity, relu,logistic.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#MLP</span>
<span class="n">best_rmse</span> <span class="o">=</span> <span class="mi">10000000</span>

<span class="k">for</span> <span class="n">activation</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;identity&quot;</span><span class="p">,</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span><span class="s2">&quot;tanh&quot;</span><span class="p">]:</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Funcion de activacion </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">activation</span><span class="p">))</span>
    
    <span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;alpha </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span>
        
        <span class="k">for</span> <span class="n">nodes</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">100</span><span class="p">]:</span>
    
            <span class="n">MLP</span> <span class="o">=</span> <span class="n">MLPRegressor</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="n">activation</span><span class="p">,</span> <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">[</span><span class="n">nodes</span><span class="p">,</span><span class="n">nodes</span><span class="p">],</span> <span class="n">solver</span><span class="o">=</span> <span class="s2">&quot;lbfgs&quot;</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span> <span class="mi">500</span><span class="p">)</span>
    
            <span class="n">all_rmse_values</span> <span class="o">=</span><span class="p">[]</span>
            <span class="n">all_r2_values</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">all_mape_values</span> <span class="o">=</span> <span class="p">[]</span>
            

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">new_wind</span><span class="p">)</span><span class="o">//</span><span class="mi">16</span><span class="p">)</span><span class="o">-</span><span class="mi">24</span><span class="p">,</span> <span class="mi">24</span><span class="p">):</span>
        
                <span class="c1"># Toma los primeros datos en training con incrementos de 24</span>
                <span class="n">training_segment_x</span> <span class="o">=</span> <span class="n">wind_x</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
                <span class="n">training_segment_y</span> <span class="o">=</span> <span class="n">wind_y</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
        
                <span class="c1">#Escalar el training</span>
                <span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">(</span><span class="n">feature_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_segment_x</span><span class="p">)</span>
                <span class="n">training_segment_x_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">training_segment_x</span><span class="p">)</span>
                
        
                <span class="n">validation_segment_x</span> <span class="o">=</span> <span class="n">wind_x</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">24</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">48</span><span class="p">]</span>
                <span class="n">validation_segment_y</span> <span class="o">=</span> <span class="n">wind_y</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">24</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">48</span><span class="p">]</span>
   
                <span class="n">MLP</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_segment_x_scaled</span><span class="p">,</span> <span class="n">training_segment_y</span><span class="p">)</span>
                <span class="c1">#Para la predicción se escala el conjunto de validación con el resultado del training para evitar la fuga de datos</span>
                <span class="n">predictions</span> <span class="o">=</span> <span class="n">MLP</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">validation_segment_x</span><span class="p">))</span>
        
                <span class="c1">#RMSE</span>
                <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">validation_segment_y</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
                <span class="n">all_rmse_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
        
        
                <span class="c1">#R2</span>
                <span class="n">r2</span><span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">validation_segment_y</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
                <span class="n">all_r2_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r2</span><span class="p">)</span>
        
        
                <span class="c1">#MAPE corregido por aquellos valores y en la validación que son 0</span>
                <span class="n">non_zero_indices</span> <span class="o">=</span> <span class="n">validation_segment_y</span> <span class="o">!=</span> <span class="mi">0</span>
                <span class="n">absolute_errors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">validation_segment_y</span> <span class="o">-</span> <span class="n">predictions</span><span class="p">)</span>
                <span class="n">absolute_errors</span> <span class="o">=</span> <span class="n">absolute_errors</span><span class="p">[</span><span class="n">non_zero_indices</span><span class="p">]</span>       
                <span class="n">mape</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">absolute_errors</span> <span class="o">/</span> <span class="n">validation_segment_y</span><span class="p">[</span><span class="n">non_zero_indices</span><span class="p">]))</span> <span class="o">*</span> <span class="mi">100</span>
                <span class="n">all_mape_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mape</span><span class="p">)</span>
               
                
            <span class="n">mape</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">all_mape_values</span><span class="p">)</span>
            <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">all_rmse_values</span><span class="p">)</span>
            <span class="n">r2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">all_r2_values</span><span class="p">)</span>
            
            
            <span class="k">if</span> <span class="n">rmse</span> <span class="o">&lt;</span> <span class="n">best_rmse</span><span class="p">:</span>
                <span class="n">best_rmse</span> <span class="o">=</span> <span class="n">rmse</span>
                <span class="n">r2_def</span> <span class="o">=</span> <span class="n">r2</span>
                <span class="n">mape_def</span> <span class="o">=</span> <span class="n">mape</span>
                <span class="n">best_parameters_MLP</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;activation&quot;</span><span class="p">:</span> <span class="n">activation</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="n">alpha</span><span class="p">,</span> <span class="s2">&quot;nodes&quot;</span><span class="p">:</span> <span class="n">nodes</span><span class="p">}</span>
        
        

<span class="nb">print</span><span class="p">(</span><span class="n">best_parameters_MLP</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">best_rmse</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r2_def</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mape_def</span><span class="p">)</span>
<span class="n">scores_MLP</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;MLP&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">mape_def</span><span class="p">,</span> <span class="n">best_rmse</span><span class="p">,</span> <span class="n">r2_def</span><span class="p">]}</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Funcion de activacion identity
alpha 0.01
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>alpha 0.1
alpha 1
Funcion de activacion relu
alpha 0.01
alpha 0.1
alpha 1
Funcion de activacion tanh
alpha 0.01
alpha 0.1
alpha 1
{&#39;activation&#39;: &#39;relu&#39;, &#39;alpha&#39;: 1, &#39;nodes&#39;: 10}
0.6486340419579278
0.5663393462102732
40.56325302556935
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scores_MLP</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;MLP&#39;: [40.56325302556935, 0.6486340419579278, 0.5663393462102732]}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">MLP_score</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;MLP&quot;</span><span class="p">:[</span><span class="mf">40.56325302556935</span><span class="p">,</span> <span class="mf">0.6486340419579278</span><span class="p">,</span> <span class="mf">0.5663393462102732</span><span class="p">]}</span>
<span class="n">SVR_score</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;SVR&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">41.84244372349804</span><span class="p">,</span> <span class="mf">0.645847143087297</span><span class="p">,</span> <span class="mf">0.5747360127629626</span><span class="p">]}</span>
<span class="n">KNN_score</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;knn&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">36.41950247171557</span><span class="p">,</span> <span class="mf">0.6156483397403705</span><span class="p">,</span> <span class="mf">0.5614265882221974</span><span class="p">]}</span>
<span class="n">Ridge_score</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Ridge&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">34.384306154975</span><span class="p">,</span> <span class="mf">0.5927235651236987</span><span class="p">,</span> <span class="mf">0.5887166863288078</span><span class="p">]}</span>
<span class="n">Lasso_score</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Lasso&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">34.40252077491132</span><span class="p">,</span> <span class="mf">0.5927006299542638</span><span class="p">,</span> <span class="mf">0.5889053044959749</span><span class="p">]}</span>
<span class="n">XGB_score</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;XGB&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">35.37884980486454</span><span class="p">,</span> <span class="mf">0.6041179919641563</span><span class="p">,</span> <span class="mf">0.5931351518058534</span><span class="p">]}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scores_dict</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">MLP_score</span><span class="p">,</span> <span class="o">**</span><span class="n">SVR_score</span><span class="p">,</span> <span class="o">**</span><span class="n">KNN_score</span><span class="p">,</span> <span class="o">**</span><span class="n">Ridge_score</span><span class="p">,</span> <span class="o">**</span><span class="n">Lasso_score</span><span class="p">,</span> <span class="o">**</span><span class="n">XGB_score</span><span class="p">}</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">scores_dict</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;MAPE&quot;</span><span class="p">,</span> <span class="s2">&quot;RMSE&quot;</span><span class="p">,</span> <span class="s2">&quot;R2&quot;</span><span class="p">])</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;MAPE&quot;</span><span class="p">,</span> <span class="s2">&quot;RMSE&quot;</span><span class="p">,</span> <span class="s2">&quot;R2&quot;</span><span class="p">]]</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>MLP</th>
      <td>40.563253</td>
      <td>0.648634</td>
      <td>0.566339</td>
    </tr>
    <tr>
      <th>SVR</th>
      <td>41.842444</td>
      <td>0.645847</td>
      <td>0.574736</td>
    </tr>
    <tr>
      <th>knn</th>
      <td>36.419502</td>
      <td>0.615648</td>
      <td>0.561427</td>
    </tr>
    <tr>
      <th>Ridge</th>
      <td>34.384306</td>
      <td>0.592724</td>
      <td>0.588717</td>
    </tr>
    <tr>
      <th>Lasso</th>
      <td>34.402521</td>
      <td>0.592701</td>
      <td>0.588905</td>
    </tr>
    <tr>
      <th>XGB</th>
      <td>35.378850</td>
      <td>0.604118</td>
      <td>0.593135</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">make_pipeline</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">MLP_model</span> <span class="o">=</span> <span class="n">MLPRegressor</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">best_parameters_MLP</span><span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">],</span> <span class="n">activation</span><span class="o">=</span><span class="n">best_parameters_MLP</span><span class="p">[</span><span class="s2">&quot;activation&quot;</span><span class="p">],</span> 
                   <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">[</span><span class="n">best_parameters_MLP</span><span class="p">[</span><span class="s2">&quot;nodes&quot;</span><span class="p">],</span> <span class="n">best_parameters_MLP</span><span class="p">[</span><span class="s2">&quot;nodes&quot;</span><span class="p">]],</span> <span class="n">solver</span><span class="o">=</span><span class="s2">&quot;lbfgs&quot;</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>

<span class="n">SVR_model</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">C</span><span class="o">=</span> <span class="n">best_parameters_SVR</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">],</span> <span class="n">gamma</span><span class="o">=</span><span class="n">best_parameters_SVR</span><span class="p">[</span><span class="s2">&quot;gamma&quot;</span><span class="p">])</span>

<span class="n">XGB_model</span> <span class="o">=</span> <span class="n">xgb</span><span class="o">.</span><span class="n">XGBRegressor</span><span class="p">(</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="n">best_parameters_XGB</span><span class="p">[</span><span class="s2">&quot;n_estimators&quot;</span><span class="p">],</span> <span class="n">learning_rate</span> <span class="o">=</span> <span class="n">best_parameters_XGB</span><span class="p">[</span><span class="s2">&quot;learning_rate&quot;</span><span class="p">],</span> 
                <span class="n">max_depth</span> <span class="o">=</span> <span class="n">best_parameters_XGB</span><span class="p">[</span><span class="s2">&quot;max_depth&quot;</span><span class="p">])</span>

<span class="n">Lasso_model</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">best_parameters_lasso</span><span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">],</span> <span class="n">fit_intercept</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">Ridge_model</span> <span class="o">=</span>  <span class="n">linear_model</span><span class="o">.</span><span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">best_parameters_ridge</span><span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">])</span>

<span class="n">Knn_model</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wind_testing_x</span> <span class="o">=</span> <span class="n">wind_testing</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">]]</span>
<span class="n">wind_testing_y</span> <span class="o">=</span> <span class="n">wind_testing</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_metrics</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="p">[(</span><span class="s2">&quot;MLP_model&quot;</span><span class="p">,</span> <span class="n">MLP_model</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;SVR_model&quot;</span><span class="p">,</span> <span class="n">SVR_model</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;XGB_model&quot;</span><span class="p">,</span> <span class="n">XGB_model</span><span class="p">),</span>
                          <span class="p">(</span><span class="s2">&quot;Lasso_model&quot;</span><span class="p">,</span> <span class="n">Lasso_model</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;Ridge_model&quot;</span><span class="p">,</span> <span class="n">Ridge_model</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;Knn_model&quot;</span><span class="p">,</span> <span class="n">Knn_model</span><span class="p">)]:</span>
    
    <span class="n">pipe</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">MinMaxScaler</span><span class="p">(</span><span class="n">feature_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">model</span><span class="p">)</span>
    
    <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">wind_x</span><span class="p">,</span> <span class="n">wind_y</span><span class="p">)</span>
    
    <span class="c1"># Realizar predicciones en el conjunto de prueba</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">wind_testing_x</span><span class="p">)</span>
    
    <span class="c1"># Calcular el MAPE</span>
    <span class="n">absolute_errors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">wind_testing_y</span> <span class="o">-</span> <span class="n">predictions</span><span class="p">)</span>
    <span class="n">non_zero_indices</span> <span class="o">=</span> <span class="n">wind_testing_y</span> <span class="o">!=</span> <span class="mi">0</span>
    <span class="n">absolute_errors</span> <span class="o">=</span> <span class="n">absolute_errors</span><span class="p">[</span><span class="n">non_zero_indices</span><span class="p">]</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">absolute_errors</span> <span class="o">/</span> <span class="n">wind_testing_y</span><span class="p">[</span><span class="n">non_zero_indices</span><span class="p">]))</span> <span class="o">*</span> <span class="mi">100</span>
    
    <span class="c1"># Calcular el RMSE</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">wind_testing_y</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
    
    <span class="c1"># Calcular el R^2</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">wind_testing_y</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
    
    <span class="c1"># Almacenar las métricas en el diccionario</span>
    <span class="n">test_metrics</span><span class="p">[</span><span class="n">model_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;MAPE&quot;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span> <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span> <span class="s2">&quot;R2&quot;</span><span class="p">:</span> <span class="n">r2</span><span class="p">}</span>
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_metrics_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">test_metrics</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">test_metrics_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  MAPE      RMSE        R2
MLP_model    17.621901  0.710735  0.771421
SVR_model    12.307527  0.563491  0.856320
XGB_model    16.818179  0.790303  0.717376
Lasso_model  16.687870  0.638687  0.815414
Ridge_model  17.118844  0.651521  0.807922
Knn_model    13.995165  0.704734  0.775264
</pre></div>
</div>
</div>
</div>
</section>
<section id="conclusiones">
<h2>Conclusiones<a class="headerlink" href="#conclusiones" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>El modelo (SVR) tiene el valor más bajo de RMSE, es decir, que tiene el menor error cuadrático medio en comparación con otros modelos, y adicionalmente el mejor R2 (0.85) y MAPE (12.3%) entre todos los modelos. Podemos decir que tiene un buen ajuste a los datos.</p></li>
<li><p>Los modelos de regresión lineal regularizada (Lasso y Ridge) tienen valores de RMSE, MAPE, R2 similares, y entre los demás modelos excluyendo al SVR tienen mejores puntuaciones.</p></li>
<li><p>K-Nearest Neighbors (KNN) tiene un valor de RMSE intermedio en comparación con otros modelos.</p></li>
<li><p>XGB_model y MLP_model: Estos modelos tienen valores más altos de RMSE en comparación con los otros modelos, lo que indica un mayor error cuadrático medio y una precisión relativamente inferior en sus predicciones.</p></li>
</ul>
<p>El mejor modelo basado en la optimización del RMSE es: <strong>SVR</strong> con parámetros <em>C: 1, gamma: 1</em>. Este permite obtener el menor RMSE de 0,563491, un R2 de 0,85 y un MAPE de 12,3%.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="FraudDetection.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">FRAUD DETECTION</p>
      </div>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eda">EDA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelado"><strong>MODELADO</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusiones">Conclusiones</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>